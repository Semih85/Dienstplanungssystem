@model EczaneNobetSonuclarViewModel

@{
    ViewBag.Title = "Nöbet İstatistik | Nöbet Sistemi";
    //int toplamUzunluk = 8500;
    double sure = 0;

    if (TempData["ModelSure"] != null)
    {
        sure = Math.Round((double)TempData["ModelSure"], 1);
    }

    var getAjaxSearch = new AjaxOptions
    {
        AllowCache = false,
        Url = Url.Action("GetSonuclar"),
        HttpMethod = "GET",
        //UpdateTargetId = "bayramlar",
        //InsertionMode = InsertionMode.Replace,
        OnSuccess = "OnSuccess",
        LoadingElementId = "loading"
    };

    //var raporKategoriler = Model.Raporlar.Select(s => new { s.RaporKategoriAdi, s.RaporKategoriId }).Distinct().ToList();
}

<div class="row mb-2">
    <div class="col">
        @*<button type="button" class="btn btn-warning btn-sm mr-2" id="btnAlanlariGizleGosterNobetciEczaneListesi">
                <i class="fa fa-refresh"></i> <span id="btnTextAlanlariGizleGoster">Alanları Göster</span>
            </button>*@

        <div class="form-inline">
            <div class="custom-control custom-checkbox mr-4 mr-lg-5 mb-2 mb-md-1">
                @Html.CheckBox("chkAlanlariGosterGizle", new { @class = "custom-control-input istatisitkFromInput", onchange = "chekBoxDegistir(this);" })
                <label class="custom-control-label font-weight-bold" for="chkAlanlariGosterGizle" title="Tablolardaki alanları görmek için bu kutucuğu seçip tekrar 'Sorgula'yınız..">Alanlar</label>
            </div>

            @*<div class="alert-info text-center mr-2 mb-2 pl-2 mb-lg-0" style="margin-top:-8px" id="raporKategoriDiv">
                    <span class="font-weight-bold small" id="raporKategoriDivBaslik">Rapor Kategorileri</span>
                    <br id="raporKategoriDivBaslikAltBosluk" />

                    @foreach (var raporKategori in raporKategoriler)
                    {
                        var raporKatgoriId = $"raporKategori{raporKategori.RaporKategoriId}";

                        <a href="#" id="@raporKatgoriId" class="badge badge-light mr-2 raporKategori">@raporKategori.RaporKategoriAdi</a>
                    }

                </div>*@

            <button class="btn btn-dark btn-sm mr-5 mb-2 mb-md-1" title="Excele Aktar" type="button" id="btnExceleAktar">
                <i class="fa fa-file-excel-o text-success"></i> Excele Aktar
                <i class="fa fa-download"></i>
            </button>

            <h4 class="text-danger mb-0" id="raporBaslik" style="margin-top:-5px">Nöbet İstatistikleri</h4>
        </div>

    </div>

</div>

<div class="pos-f-t border border-primary">

    <div class="collapse" id="navbarToggleExternalContent">
        <div class="bg-white p-4">
            <h5 class="h4"><i class="fa fa-pie-chart fa-lg text-danger"></i> Nöbet İstatistik ve Raporları</h5>
            <span class="text-muted">Bu sayfada aşağıdaki seçenekleri kullanarak nöbet ile ilgili bir çok analiz yapabilirsiniz.</span>
        </div>
    </div>

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <span class="navbar-brand" data-toggle="collapse" data-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fa fa-bar-chart fa-lg text-danger"></i>
        </span>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        @Html.Hidden("sure", sure)

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            @using (Ajax.BeginForm("GetSonuclar", "EczaneNobetSonuc", null, new { @class = "form-inline my-2 my-lg-0", id = "formTumu" }))
            {
                @Html.AntiForgeryToken()
                @Html.HiddenFor(model => model.BaslangicTarihi)
                @Html.HiddenFor(model => model.BitisTarihi)

                <div class="input-group input-daterange mb-2 mb-lg-0 mr-2">
                    <div class="input-group-prepend">
                        <span class="input-group-text p-2">
                            <i class="fa fa-calendar" aria-hidden="true" id="btnSilBaslangicTarihiFiltre"></i>
                            <img src="~/Content/images/Icons8-Windows-8-Data-Clear-Filters.ico" style="width:15px; display:none;" id="btnSilBaslangicTarihi" title="Başlangıç Tarihini Sil" />
                        </span>
                    </div>
                    @Html.TextBox("TarihBaslangic", null, new
                    {
                        @class = "form-control datepicker istatisitkFromInput",
                       //data_toggle = "tooltip",
                       //data_placement = "top",
                       //title = "Başlangıç Tarihi",
                       autocomplete = "off",
                       placeHolder = "Başlangıç",
                       style = "width:100px;"
                   })

                    <div class="input-group-addon mt-1 p-1">-</div>

                    @Html.TextBox("TarihBitis", null, new
                    {
                        @class = "form-control datepicker istatisitkFromInput",
                       //data_toggle = "tooltip",
                       //data_placement = "top",
                       //title = "Bitiş Tarihi",
                       autocomplete = "off",
                       placeHolder = "Bitiş",
                       style = "width:100px;"
                   })
                    <div class="input-group-append">
                        <span class="input-group-text p-2">
                            <i class="fa fa-calendar" aria-hidden="true" id="btnSilBitisTarihiFiltre"></i>
                            <img src="~/Content/images/Icons8-Windows-8-Data-Clear-Filters.ico" style="width:15px; display:none;" id="btnSilBitisTarihi" title="Bitiş Tarihini Sil" />
                        </span>
                    </div>
                </div>

                @Html.DropDownList("GunGrupId", null, htmlAttributes: new
                {
                    @class = "form-control istatisitkFromInput mr-2 mb-2 mb-md-0",
                    //data_style = "btn btn-outline-primary",
                    //multiple = "true",
                    //data_width = "auto",
                    //data_actions_box = "true",
                    //mobile = "true",
                    //data_live_search = "true",
                    //data_selected_text_format = "count > 0",
                    //title = "-Gün Grupları Seçiniz-",
                    //@style = "border-color:red"
                },optionLabel: "Tüm Gün Grupları")

                if (ViewBag.NobetGrupGorevTipSayisi > 4)
                {
                    @Html.DropDownList("nobetGrupGorevTipId", null, htmlAttributes: new
                        {
                            @class = "form-control selectpicker istatisitkFromInput mr-2",
                           //data_style = "btn btn-outline-primary",
                           multiple = "true",
                           //data_width = "auto",
                           data_actions_box = "true",
                           mobile = "true",
                           data_live_search = "true",
                           data_selected_text_format = "count > 0",
                           title = "Nöbet Grubu Seçiniz..",
                        })
                }
                else
                {
                    @Html.DropDownList("nobetGrupGorevTipId", null, htmlAttributes: new
                       {
                           @class = "form-control selectpicker istatisitkFromInput mr-2",
                           //data_style = "btn btn-outline-primary",
                           multiple = "true",
                           //data_width = "auto",
                           data_actions_box = "true",
                           mobile = "true",
                           //data_live_search = "true",
                           data_selected_text_format = "count > 0",
                           title = "Nöbet Grubu Seçiniz.."
                       }
                        //,optionLabel: "-Nöbet Grubu Seçiniz-"
                        )
                }

                @Html.DropDownList("raporId", null, htmlAttributes: new
                {
                   @class = "form-control selectpicker mr-4 mr-md-2 ",
                   //show_menu_arrow = "true",
                   //multiple = "true",
                   //data_width = "auto",
                   //data_actions_box = "true",
                   //mobile = "true",
                   data_size = "15",
                   data_live_search = "true",
                   //data_selected_text_format = "count > 4",
                   title = "Rapor Seçiniz...",
                   data_dropup_auto="false"
                   //data_hide_disabled = true
                })

                <div class="form-group">
                    <span class="input-group-btn mr-3">
                        <button type="button" id="submitSorgula" class="btn btn-sm btn-primary"><i class="fa fa-search"></i> Sorgula</button>
                    </span>
                    <span id="wait" class="spinner-border text-primary" role="status" style="display:none;">
                        <span class="sr-only">Loading...</span>
                    </span>
                </div>
            }
        </div>
    </nav>
</div>

@Html.Hidden("sure", Model.EczaneNobetSonuclar.ToplamSure)
@Html.Hidden("CozumSuresi", Model.EczaneNobetSonuclar.CozumSuresi)

<!-- #region raporlar -->

<div class="row mt-2">
    <div class="col-sm-12 col-md-12" id="raporlar">
        @*<div id="raporMasterDiv" class="pasif"></div>*@
    </div>
</div>

<!-- #endregion -->
<!-- #region styles -->
@section styles{

    @Styles.Render("~/bundle/c3/style")
    @Styles.Render("~/bundle/pivot/style")
    @Styles.Render("~/bundle/alert_toastr/style")
    @Styles.Render("~/bundle/bootstrap-select/style")
    @Styles.Render("~/bundle/bootstrap-datepicker/style")
    @Styles.Render("~/bundle/jqueryui/style")

    <style>
        .toast-message {
            font-weight: bold;
        }

        .toast {
            opacity: 1 !important;
        }

        /*.bootstrap-table-info{
            background-color:aqua;
            color:red;
        }*/
    </style>

    <style>

        .ui-helper-hidden-accessible {
            position: absolute;
            left: -99999999px;
        }
        /*body {
            font-family: Verdana;
        }*/

        .c3-line, .c3-focused {
            stroke-width: 3px !important;
        }

        .c3-bar {
            stroke: white !important;
            stroke-width: 1;
        }

        .c3 text {
            font-size: 12px;
            color: grey;
        }

        .tick line {
            stroke: white;
        }

        .c3-axis path {
            stroke: grey;
        }

        .c3-circle {
            opacity: 1 !important;
        }

        .c3-xgrid-focus {
            visibility: hidden !important;
        }
    </style>
}
<!-- #endregion -->
<!-- #region scripts -->

@section scripts{
    @Scripts.Render("~/bundle/ajax")
    @Scripts.Render("~/bundle/bootstrap-select/scripts")
    @Scripts.Render("~/bundle/alert_toastr/scripts")
    @Scripts.Render("~/bundle/d3/scripts")
    @Scripts.Render("~/bundle/c3/scripts")
    @Scripts.Render("~/bundle/queryui/scripts")
    @Scripts.Render("~/bundle/pivot/scripts")
    @Scripts.Render("~/bundle/c3_renderers/scripts")
    @Scripts.Render("~/bundle/pager")
    @Scripts.Render("~/bundle/bootstrap-datepicker_tr/scripts")
    <!-- #region ajax json data -->
    <script>

        function uyariDivOlustur(mesaj, divAdi, parentDivId) {
            var uyariMesaj = "<i class='fa fa-info-circle'></i> Bu raporu <strong>" + mesaj + "</strong> görüntülemek için <strong> veri bulunmamaktadır...</strong>";

            if ($('#' + divAdi).length === 0) {
                $('<div/>', {
                    id: divAdi,
                    class: 'alert alert-info alert-dismissible fade show',
                    html: uyariMesaj
                }).appendTo('#' + parentDivId);

                var node = $('<span aria-hidden="true" />').html("&times;");
                $('<button type="button" class="close" data-dismiss="alert" aria-label="Close" />')
                    .appendTo('#' + divAdi)
                    .append(node);
            }
        }

        var urlDagilimlar = '@Url.Action("GetSonuclar")';
        var urlAyniGunNobet = '@Url.Action("GetAyniGunNobetler")';
        var urlEczaneNobetAlacakVerecek = '@Url.Action("GetEczaneNobetAlacakVerecekler")';
        var serializedForm;

        var nobetGrubu = new Array();
        var baslangicTarihi;
        var bitisTarihi;
        var raporId;
        var raporBaslik;

        var nobetciEczaneler = null;
        var nobetciEczanelerMazeretIstek = null;
        var gunDagilim = null;
        var gunDagilimBayramlar = null;
        var gunDagilimHaftaIci = null;
        var ikiliAyDagilim = null;

        var dagilimlar = null;
        var dagilimlarFiltreli = null;
        var gunDagilimiMaxMin = new Array();
        var gunDagilimiMaxMinFiltreli = null;
        var gunDagilimiMaxMinTumu = null;
        var dagilimlarTumu = null;
        var dagilimlarPivot = new Array();
        var dagilimlarPlanlananGerceklesen = new Array();

        var dagilimlarPlanlananGerceklesenTumu = null;

        var gunFarklariFrekanslar = new Array();
        var gunFarklariFrekanslarTumu = null;
        var gunFarklariFrekanslarFiltreli = null;

        var gunFarklariTumSonuclar = new Array();
        var gunFarklariTumSonuclarTumu = null;
        var gunFarklariTumSonuclarFiltreli = null;

        var eczaneNobetAlacakVerecek = null;
        var alacakVerecekLitesi = new Array();
        var alacakVerecekLitesiTumu = null;
        var alacakVerecekLitesiFiltreli = null;
        var dagilimlarPlanlananGerceklesenFiltreli = null;

        var ayniGunNobet = null;
        var ayniGunNobetTutanEczaneler = new Array();
        var ayniGunNobetTutanEczanelerOzet = new Array();
        var altGrupAyniGunNobetTutanEczaneler = new Array();
        var altGrupSiraliAyniGunNobetTutanEczaneler = new Array();
        var esGrubaAyniGunYazilanNobetler = new Array();
        var kalibrasyonEslemeliNobetler = new Array();
        var nobetUstGrupId;

        var pivotAlanlariGoster = false;
        var pivotAlanlariGosterNobetciListesi = false;
        var pivotAlanlariGosterGunOzetGrafik = false;
        var pivotAlanlariGosterGunDagilim = false;
        var pivotAlanlariGosterGunDagilimGrafikler = false;
        var pivotAlanlariGosterAyDagilimGrafikler = false;
        var pivotAlanlariGosterMevsimDagilim = false;
        var pivotAlanlariGosterKalibrasyonluDetayli = false;
        var pivotAlanlariGosterNobetDurumlari = false;
        var pivotAlanlariGosterPlanlanaGerceklesen = true;

        function getJsonAyniGunNobetTutanlar(url, formElements, raporId) {
            $.ajax({
                dataType: "json",
                url: url,
                type: "get",
                data: formElements,
                success: function (data) {

                    ayniGunNobet = JSON.parse(JSON.stringify(data));
                    //alert(1)
                    //aynı Gün Nöbet Tutan Eczaneler
                    //alert(ayniGunNobet.AltGrupAyniGunNobetTutanEczaneler.length)
                    if (raporId == 22) {
                        $.each(ayniGunNobet.AyniGunNobetTutanEczanelerOzet, function (index, s) {
                            ayniGunNobetTutanEczanelerOzet.push({
                                G1Eczane: s.G1Eczane,
                                G2Eczane: s.G2Eczane,
                                ["G1 Nöbet Grubu"]: s.G1NobetGrupAdi,
                                ["G2 Nöbet Grubu"]: s.G2NobetGrupAdi,
                                ["G1 Nöbet Alt Grubu"]: s.G1NobetAltGrupAdi,
                                ["G2 Nöbet Alt Grubu"]: s.G2NobetAltGrupAdi,
                                ["Gün Grup"]: s.GunGrup,
                                //Grup: s.Grup,
                                //["Alt Grup"]: s.AltGrupAdi,
                                ["Aynı Gün Nöbet Sayısı"]: s.AyniGunNobetSayisi,
                                //["Nöbet Tarihi"]: s.TarihAciklama,
                                //["Yıl-Ay"]: s.YilAy
                            });
                        });
                        ayniGunNobetTutanEczanelerOzet = JSON.parse(JSON.stringify(ayniGunNobetTutanEczanelerOzet));
                    }

                    //alert("ayniGunNobetTutanEczanelerOzet.length: " + ayniGunNobetTutanEczanelerOzet.length)

                    if (raporId == 21) {
                        $.each(ayniGunNobet.AyniGunNobetTutanEczaneler, function (index, s) {
                            ayniGunNobetTutanEczaneler.push({
                                G1Eczane: s.G1Eczane,
                                G2Eczane: s.G2Eczane,
                                ["G1 Nöbet Grubu"]: s.G1NobetGrupAdi,
                                ["G2 Nöbet Grubu"]: s.G2NobetGrupAdi,
                                ["G1 Nöbet Alt Grubu"]: s.G1NobetAltGrupAdi,
                                ["G2 Nöbet Alt Grubu"]: s.G2NobetAltGrupAdi,
                                ["Gün Grup"]: s.GunGrup,
                                //Grup: s.Grup,
                                //["Alt Grup"]: s.AltGrupAdi,
                                ["Aynı Gün Nöbet Sayısı"]: s.AyniGunNobetSayisi,
                                ["Nöbet Tarihi"]: s.TarihAciklama,
                                ["Yıl-Ay"]: s.YilAy
                            });
                        });
                        ayniGunNobetTutanEczaneler = JSON.parse(JSON.stringify(ayniGunNobetTutanEczaneler));
                    }

                    if (raporId == 23) {
                        //eş grup
                        esGrubaAyniGunYazilanNobetler = JSON.parse(JSON.stringify(ayniGunNobet.EsGrubaAyniGunYazilanNobetler));
                    }
                    //alert(2)

                    ilgiliRaporuOlustur(raporId);
                },
                error: function (data) {
                    alert('Hata. Veri okunamadı! (Aynı gün nöbetler)');
                },
            });
        }

        function getJsonEczaneNobetAlacakVerecekler(url, formElements, raporId) {
            $.ajax({
                dataType: "json",
                url: url,
                type: "get",
                data: formElements,
                success: function (data) {

                    eczaneNobetAlacakVerecek = JSON.parse(JSON.stringify(data));

                    var ilgiliRaporlar = [14, 15, 16];

                    if (ilgiliRaporlar.find(x=> x == raporId) > 0) {
                                            //eczane nöbet alacak verecek
                        $.each(eczaneNobetAlacakVerecek.EczaneNobetAlacakVerecek, function (index, s) {
                            alacakVerecekLitesi.push({
                                Eczane: s.EczaneAdi,
                                //AnahtarSıra: s.AnahtarSıra,
                                ["Gün Grup"]: s.GunGrup,
                                ["Nöbet Grubu"]: s.NobetGrupId + ' ' + s.NobetGrupAdi,
                                AnahtarTarih: s.AnahtarTarihAciklama,
                                ["Borç Durumu"]: borcDurum(s.BorcluGunSayisi),
                                BorçluGünSayısı: s.BorcluGunSayisi,
                                NöbetSayısı: s.NobetSayisi,
                                SonNöbetTarihi: s.SonNobetTarihiAciklama
                            });
                        });
                        alacakVerecekLitesi = JSON.parse(JSON.stringify(alacakVerecekLitesi));
                        alacakVerecekLitesiTumu = alacakVerecekLitesi;
                    }

                    if (raporId == 17) {

                        $.each(eczaneNobetAlacakVerecek.SonuclarPlanlananVeGercek, function (index, n) {
                        dagilimlarPlanlananGerceklesen.push({
                                //EczaneNobetGrupId: n.EczaneNobetGrupId,
                                //EczaneId: n.EczaneId,
                                ["NöbetGrupGörevTipId"]: n.NobetGrupGorevTipId,
                                ["Yıl-Ay"]: n.Yıl_Ay,
                                ["Yıl"]: n.Yil,
                                Ay: n.Ay,
                                //["Gün"]: n.Gun,
                                ["Gün Tanım"]: n.GunTanim,
                                ["Gün Grup"]: n.GunGrup,
                                //["Görev Tipi"]: n.GorevTipi,
                                ["Nöbet Grubu"]: n.NobetGrubu,
                                Eczane: n.EczaneAdi,
                                Tarih: n.TarihAciklama,
                                Tarih2: n.Tarih2,
                                ["Ay İkili"]: n.AyIkili,
                                Mevsim: n.Mevsim,
                                //["Mazerete Nöbet"]: n.MazereteNobet,
                                //["Nöbet Tip"]: n.NobetTipId,
                                ["Mazeret/İstek"]: n.NobetTipi,
                                ["Eczane Sonuç"]: n.EczaneSonucAdi,
                                ["Alt Grup Adı"]: n.NobetAltGrubu,

                                //["Nöbet Sayısı"]: 1,
                                ["Eczane Kapanma Tarihi"]: n.EczaneKapanmaTarihi,
                                ["Sonuç Türü"]: n.SonucTuruAdi
                            });
                        });

                        dagilimlarPlanlananGerceklesenTumu = dagilimlarPlanlananGerceklesen;
                    }

                    ilgiliRaporuOlustur(raporId);
                },
                error: function (data) {
                    alert('Hata. Veri okunamadı!');
                },
            });
        }

        function getJsonDagilimlar(url, formElements, raporId) {

            //alert("raporId: " + raporId)

            //alert("ilgiliRaporlar.indexOf(raporId): " + ilgiliRaporlar.find(x=> x == raporId))

            $.ajax({
                dataType: "json",
                url: url,
                type: "get",
                data: formElements,
                success: function (data) {
                    //$("#raporlar").show();
                    dagilimlar = JSON.parse(JSON.stringify(data));
                    nobetUstGrupId = dagilimlar.NobetUstGrupId;
                    //console.log(dagilimlar)
                    //PivotSonuclar
                    var ilgiliRaporlar = [1, 2, 3, 4, 5, 6, 25, 26, 27, 28, 29];

                    if (ilgiliRaporlar.find(x=> x == raporId) > 0) {

                        $.each(dagilimlar.PivotSonuclar, function (index, n) {
                            dagilimlarPivot.push({
                                EczaneNobetGrupId: n.EczaneNobetGrupId,
                                EczaneId: n.EczaneId,
                                ["NöbetGrupGörevTipId"]: n.NobetGrupGorevTipId,
                                ["Yıl-Ay"]: n.Yıl_Ay,
                                ["Yıl"]: n.Yil,
                                Ay: n.Ay,
                                Hafta: n.Hafta,
                                //["Gün"]: n.Gun,
                                ["Gün Tanım"]: n.GunTanim,
                                ["Gün Grup"]: n.GunGrup,
                                ["Görev Tipi"]: n.GorevTipi,
                                ["Nöbet Grubu"]: n.NobetGrubu,
                                Eczane: n.Eczane,
                                Tarih: n.Tarih,
                                Tarih2: n.Tarih2,
                                ["Ay İkili"]: n.AyIkili,
                                Mevsim: n.Mevsim,
                                //["Mazerete Nöbet"]: n.MazereteNobet,
                                //["Nöbet Tip"]: n.NobetTipId,
                                ["Mazeret/İstek"]: n.NobetTipi,
                                ["Eczane Sonuç"]: n.EczaneSonucAdi,
                                ["Alt Grup Adı"]: n.NobetAltGrubu,

                                ["Nöbet Durumu"]: n.NobetDurumAdi,
                                ["Nöbet Durum Tipi"]: n.NobetDurumTipAdi,
                                ["Nöbet Sayısı"]: 1,
                                ["Kalibrasyon Değeri"]: n.KalibrasyonDeger,
                                ["Eczane Kapanma Tarihi"]: n.EczaneKapanmaTarihi,
                                ["Gün Ağırlık"]: n.AgirlikDegeri,
                                ["Özel Gün"]: n.NobetOzelGunAdi,
                                ["Özel Gün Ktg."]: n.NobetOzelGunKategoriAdi
                            });
                        });

                        dagilimlarTumu = dagilimlarPivot;
                    }

                    //alert(dagilimlarPivot.length)
                    //alert("raporId: " + raporId)

                    if (raporId == 7) {

                        $.each(dagilimlar.GunDagilimiMaxMin, function (index, n) {
                            gunDagilimiMaxMin.push({
                                ["Gün Grup"]: n.GunGrup,
                                ["Nöbet Grubu"]: n.NobetGrubu,
                                ["Nöbet Sayısı (En çok)"]: n.NobetSayisiMax,
                                ["Nöbet Sayısı (En az)"]: n.NobetSayisiMin,
                                ["Nöbet Sayısı Farkı"]: n.NobetSayisiFarki,
                                ["Borçlu Gün Sayısı Farkı"]: n.BorcluGunSayisiFarki,
                                //["Son Nöbet Tarihi"]: n.SonNobetTarihiAciklama
                            });
                        });

                        gunDagilimiMaxMinTumu = gunDagilimiMaxMin;
                    }

                    var ilgiliRaporlarGunFarkiFrekanslar = [8, 9, 10];

                    if (ilgiliRaporlarGunFarkiFrekanslar.find(x=> x == raporId) > 0 ) {
                        //alert(gunDagilimiMaxMin.length)
                        //gün farkı frekanslar
                        $.each(dagilimlar.GunFarklariFrekanslar, function (index, n) {
                            gunFarklariFrekanslar.push({
                                ["Hafta Farkı"]: n.HaftaFarki,
                                ["Ay Farkı"]: n.AyFarki,
                                ["Gün Farkı"]: n.GunFarki,
                                Eczane: n.EczaneAdi,
                                ["Gün Grup"]: n.GunGrup,
                                ["Nöbet Grubu"]: n.NobetGrupAdi,
                                ["Görev Tipi"]: n.NobetGorevTipAdi,
                                ["Eczane Sayısı"]: n.FrekanstakiEczaneSayisi,
                            });
                        });
                        gunFarklariFrekanslar = JSON.parse(JSON.stringify(gunFarklariFrekanslar));
                        gunFarklariFrekanslarTumu = gunFarklariFrekanslar;
                    }

                    var ilgiliRaporlarGunFarklari = [11, 12, 13];

                    if (ilgiliRaporlarGunFarklari.find(x=> x == raporId) > 0 ) {
                        //gün farkı tüm sonuçlar
                        $.each(dagilimlar.GunFarklariTumSonuclar, function (index, s) {
                            gunFarklariTumSonuclar.push({
                                ["Hafta Farkı"]: s.HaftaFarki,
                                ["Ay Farkı"]: s.AyFarki,
                                ["Gün Farkı"]: s.GunFarki,
                                Index: s.Index,
                                Nöbet1: s.Nobet1,
                                N1Yıl: s.Nobet1Yil,
                                N1Ay: s.Nobet1Ay,
                                N1Gun: s.Nobet1Gun,

                                Nöbet2: s.Nobet2,
                                N2Yıl: s.Nobet2Yil,
                                N2Ay: s.Nobet2Ay,
                                N2Gun: s.Nobet2Gun,
                                Eczane: s.EczaneAdi,
                                ["Gün Grup"]: s.GunGrup,
                                ["Görev Tipi"]: s.NobetGorevTipAdi,
                                ["Nöbet Grubu"]: s.NobetGrupAdi
                            });
                        });
                        gunFarklariTumSonuclar = JSON.parse(JSON.stringify(gunFarklariTumSonuclar));
                        gunFarklariTumSonuclarTumu = gunFarklariTumSonuclar;
                    }

                    var ilgiliRaporlarAltGruplarlaAyniGunNobetler = [18, 19, 20];

                    if (ilgiliRaporlarAltGruplarlaAyniGunNobetler.find(x => x == raporId) > 0) {

                        var altGrup = $.grep(dagilimlar.AltGrupAyniGunNobetTutanEczaneler, function (n, i) {
                            return n.AltGrupAdi != "Kendisi";
                        });

                        if (raporId == 18) {
                            //alt grupla aynı Gün Nöbet Tutan Eczaneler
                            $.each(altGrup, function (index, s) {
                                altGrupAyniGunNobetTutanEczaneler.push({
                                    G1Eczane: s.G1Eczane,
                                    G2Eczane: s.G2Eczane,
                                    Grup: s.Grup,
                                    AltGrup: s.AltGrupAdi,
                                    ["Aynı Gün Nöbet Sayısı"]: s.AyniGunNobetSayisi,
                                    //Tarih: s.Tarih.toDateString("yyy MM dd, ddd"),
                                    //Yıl_Ay: $.datepicker.formatDate('yyyyMM', s.Tarih),
                                    //Tarih = String.Format("{0:yyy MM dd, ddd}", s.Tarih),
                                    //Yıl_Ay = Convert.ToInt32(String.Format("{0:yyyyMM}", s.Tarih)),
                                    //["Gün Grup"] : s.GunGrup
                                });
                            });
                            altGrupAyniGunNobetTutanEczaneler = JSON.parse(JSON.stringify(altGrupAyniGunNobetTutanEczaneler));
                        }
                        else {
                            //alt grup sirali aynı Gün Nöbet Tutan Eczaneler
                            $.each(altGrup, function (index, s) {
                                altGrupSiraliAyniGunNobetTutanEczaneler.push({
                                    G1Eczane: s.G1Eczane,
                                    G2Eczane: s.G2Eczane,
                                    Grup: s.Grup,
                                    AltGrup: s.AltGrupAdi,
                                    ["Aynı Gün Nöbet Sayısı"]: s.AyniGunNobetSayisi,
                                    Tarih: s.TarihAciklama,
                                    ["Gün Grup"]: s.GunGrup,
                                    ["Yıl-Ay"]: s.YilAy
                                });
                            });
                            altGrupSiraliAyniGunNobetTutanEczaneler = JSON.parse(JSON.stringify(altGrupSiraliAyniGunNobetTutanEczaneler));
                        }
                    }

                    //kalibrasyon Eslemeli Nobetler
                    if (raporId == 24) {
                        kalibrasyonEslemeliNobetler = JSON.parse(JSON.stringify(dagilimlar.KalibrasyonluToplamlar));
                    }

                    ilgiliRaporuOlustur(raporId);
                },
                error: function (data) {
                    alert('Hata. Veri okunamadı!');
                },
            });
        }

        function borcDurum(borcSayisi) {

            var borcluGunSayisi = parseFloat(borcSayisi);

            if (borcluGunSayisi == 0) {
                return "Borç/alacak yok."
            }
            else if (borcluGunSayisi > 0) {
                return "Sistemden alacaklı"
            }
            else {
                return "Sisteme borçlu"
            }
        }
        //var someObj = {
        //        PostId: $('.postid').val(),
        //        UserName: $('#username').val(),
        //        DateCreated: new Date(),
        //        CommentText: $('#comment').val()
        //    };

        var icRaporDivAdi = "";
        var icRaporDivId = "";

        //$('#raporKategoriDiv').hover(function () {
        //    $('#raporKategoriDivBaslik').toggle();
        //    $('#raporKategoriDivBaslikAltBosluk').toggle();
        //});

        $('.istatisitkFromInput').change(function () {
            pivotSekilleriSifirla();
            //alert(1)
        });

        $('#submitSorgula').click(function () {
            //alert(1)
            if (nobetGrubu.length == 0) {

                alert("Nöbet grubu seçiniz..")
                e.preventDefault();
                //$("#raporId option:selected").prop("selected", false)
                return false;
            }

            //$("#raporMasterDiv").empty().html();

            //dagilimlar = null;
            //dagilimlarTumu = null;
            //dagilimlarPivot = new Array();

            pivotSekilleriSifirla();

            icRaporBilsiniGuncelle()

            //$('#raporMasterDiv').clear();
                //.append('<div id = ' + icRaporDivAdi + '></div>');

            //alert("submitSorgula: " + icRaporDivAdi)
            divAktifPasif(icRaporDivAdi);

            //$("#submitSorgula").on("click", function(){
            //        //$(icRaporDivId).pivotUI(mps, JSON.parse($.cookie("pivotConfig")), true);
            //});

            $('.pasif').hide();
            $('.aktif').show();

            var ilgiliRaporlarDagilimlar = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 18, 19, 20, 24, 25, 26, 27, 28, 29];
            var ilgiliRaporlarAlacakVerecekler = [14, 15, 16, 17];
            var ilgiliRaporlarAyniGunNobetler = [21, 22, 23];

            if (raporId == 27) {
                $('#GunGrupId').val(2);
            }
            //else if (raporId == 28) {
            //    $('#GunGrupId').val(3);
            //}

            serializedForm = $('#formTumu').serialize();

            if (ilgiliRaporlarDagilimlar.find(x => x == raporId) > 0) {
                getJsonDagilimlar(urlDagilimlar, serializedForm, raporId)
            }
            else if (ilgiliRaporlarAlacakVerecekler.find(x => x == raporId) > 0) {
                getJsonEczaneNobetAlacakVerecekler(urlEczaneNobetAlacakVerecek, serializedForm, raporId);
            }
            else if (ilgiliRaporlarAyniGunNobetler.find(x => x == raporId) > 0) {
                getJsonAyniGunNobetTutanlar(urlAyniGunNobet, serializedForm, raporId);
            }

        });

        function icRaporBilsiniGuncelle() {
            icRaporDivAdi = 'icRapor' + raporId;
            icRaporDivId = '#' + icRaporDivAdi;

            $('#raporBaslik').text(raporBaslik);
            //var element = document.getElementById(icRaporDivAdi);

            if (!$(icRaporDivId).length) {
                //alert(icRaporDivAdi)
                //alert("boyut: " + $(icRaporDivAdi).length)
                $('<div/>', {
                        id: icRaporDivAdi,
                        class: 'icRapor pasif',
                        //html: ""
                    }).appendTo('#' + "raporlar");
            }
        }

        $('#btnExceleAktar').click(function () {
            var ilgiliDiv = icRaporDivId + ' > table';
            tableToExcel('testTable', 'Nöbet Yaz');
        });

        function divAktifPasif(divClass) {

            divClass = '#' + divClass;

            //alert(divClass)

            $(divClass).switchClass('pasif', 'aktif');
        }
        
        $("#raporId").on('change', function () {

            raporParamsBelirle();

            icRaporBilsiniGuncelle()

            $('.icRapor').switchClass('aktif', 'pasif');

            divAktifPasif(icRaporDivAdi);
            
            $('.pasif').hide();
            $('.aktif').show();

            ilgiliRaporuOlustur(raporId)
        });

        function ilgiliRaporuOlustur(raporId) {

            //alert("raporId: " + raporId)
                if (raporId == 1) {//r01
                    if (nobetciEczaneler != null) {
                        nobetciEczaneler;
                    }
                    else {
                        nobetciListesi();
                    }
                }
                else if (raporId == 2) {//r02
                    if (gunDagilim != null) {
                        gunDagilim;
                    }
                    else {
                        gunDagilimlar();
                    }
                }
                else if (raporId == 3) {//r03
                    if (gunGrafik2 != null) {
                        gunGrafik2;
                    }
                    else {
                        gunDagilimGrafikler();
                    }
                }
                else if (raporId == 4) {//r04
                    if (ayDagilim != null) {
                        ayDagilim;
                    }
                    else {
                        ayDagilimlar();
                    }
                }
                else if (raporId == 5) {//r05
                    if (mevsimDagilim != null) {
                        mevsimDagilim;
                    }
                    else {
                        mevsimDagilimlar();
                    }
                }
                else if (raporId == 6) {//r06
                    if (tarihDagilim != null) {
                        tarihDagilim;
                    }
                    else {
                        tarihDagilimlar();
                    }
                }
                else if (raporId == 7) {//r07
                    if (gunGrafik != null) {
                        gunGrafik;
                    }
                    else {
                        gunGrafikOlustur();
                    }
                }
                else if (raporId == 8) {//r08
                    if (gunFarkiGrafikVeri != null) {
                        gunFarkiGrafikVeri;
                    }
                    else {
                        gunFarkiGrafik();
                    }
                }
                else if (raporId == 9) {//r09
                    if (gunFarkiOzetListesi != null) {
                        gunFarkiOzetListesi;
                    }
                    else {
                        gunFarkiOzet();
                    }
                }
                else if (raporId == 10) {//r10
                    if (gunFarkiFrekansListesi != null) {
                        gunFarkiFrekansListesi;
                    }
                    else {
                        gunFarkiFrekans();
                    }
                }
                else if (raporId == 11) {//r11
                    if (gunFarkiDonguListesi != null) {
                        gunFarkiDonguListesi;
                    }
                    else {
                        donguler();
                    }
                }
                else if (raporId == 12) {//r12
                    if (gunFarkiDetayliArtanListesi != null) {
                        gunFarkiDetayliArtanListesi;
                    }
                    else {
                        gunFarkiDetayliArtanlar();
                    }
                }
                else if (raporId == 13) {//r13
                    if (gunFarkiDetayliAzalanListesi != null) {
                        gunFarkiDetayliAzalanListesi;
                    }
                    else {
                        gunFarkiDetayliAzalanlar();
                    }
                }
                else if (raporId == 14) {//r14
                    if (alacakVerecekGrafikVeri != null) {
                        alacakVerecekGrafikVeri;
                    }
                    else {
                        alacakVerecekGrafik();
                    }
                }
                else if (raporId == 15) {//r15
                    if (alacakVereceklerOzet != null) {
                        alacakVereceklerOzet;
                    }
                    else {
                        alacakVerecekOzet();
                    }
                }
                else if (raporId == 16) {//r16
                    if (alacakVereceklerList != null) {
                        alacakVereceklerList;
                    }
                    else {
                        alacakVerecekListe();
                    }
                }
                else if (raporId == 17) {//r17
                    if (planlananVeGerceklesenNobetListesi != null) {
                        planlananVeGerceklesenNobetListesi;
                    }
                    else {
                        planlananVeGerceklesenNobetler();
                    }
                }
                else if (raporId == 18) {//r18
                    if (altGrupDagilim != null) {
                        altGrupDagilim;
                    }
                    else {
                        altGrupDagilimlar();
                    }
                }
                else if (raporId == 19) {//r19
                    if (altGrupGunGrup != null) {
                        altGrupGunGrup;
                    }
                    else {
                        altGrupGunGrupDagilimlar();
                    }
                }
                else if (raporId == 20) {//r20
                    if (altGrupSirali != null) {
                        altGrupSirali;
                    }
                    else {
                        altGrupSiraliDagilimlar();
                    }
                }
                else if (raporId == 21) {//r21
                    if (ayniGunDagilimTablo != null) {
                        ayniGunDagilimTablo;
                    }
                    else {
                        ayniGunDagilimlarTablo();
                    }
                }
                else if (raporId == 22) {//r22
                    if (ayniGunDagilim != null) {
                        ayniGunDagilim;
                    }
                    else {
                        ayniGunDagilimlar();
                    }
                }
                else if (raporId == 23) {//r23

                    AyniGunNobetTutanEsGruplar();

                    //if (alacakVerecekGrafikVeri != null) {
                    //    alacakVerecekGrafikVeri;
                    //}
                    //else {
                    //    alacakVerecekGrafik();
                    //}
                }
                else if (raporId == 24) {//r24
                    if (kalibrasyonluNobetDagilim != null) {
                        kalibrasyonluNobetDagilim;
                    }
                    else {
                        kalibrasyonluNobetDagilimlar();
                    }
                }
                else if (raporId == 25) {//r25
                    if (nobetDurumDagilim != null) {
                        nobetDurumDagilim;
                    }
                    else {
                        nobetDurumTabloOlustur();
                    }
                }
                else if (raporId == 26) {//r26
                    if (nobetciEczanelerMazeretIstek != null) {
                        nobetciEczanelerMazeretIstek;
                    }
                    else {
                        nobetciListesiMazeretIstek();
                    }
                }
                else if (raporId == 27) {//r27
                    if (gunDagilimBayramlar != null) {
                        gunDagilimBayramlar;
                    }
                    else {
                        gunDagilimlarBayramlar();
                    }
                }
                else if (raporId == 28) {//r28
                    if (gunDagilimHaftaIci != null) {
                        gunDagilimHaftaIci;
                    }
                    else {
                        gunDagilimlarHaftaIci();
                    }
                }
                else if (raporId == 29) {//r29
                    if (ikiliAyDagilim != null) {
                        ikiliAyDagilim;
                    }
                    else {
                        ikiliAyDagilimlar();
                    }
                }        
            }

    </script>
    <!-- #endregion -->
    <!-- #region dağılımlar -->
    <script type="text/javascript">

        $('#pills-dagilim-tab').click(function () {
            $('#inputTarihAralik').show();

            if ($("#pills-nobetci-tab").hasClass("active")) {
                $('#btnExceleAktar').show();
                if (nobetciEczaneler != null) {
                    nobetciEczaneler;
                }
                else {
                    nobetciListesi();
                }
            }
            else if ($("#pills-gunOzetGrafik-tab").hasClass("active")) {
                $('#btnExceleAktar').hide();
                if (gunDagilimiMaxMin != null) {
                    gunDagilimiMaxMin;
                }
                else {
                    gunGrafikOlustur();
                }
            }
            else if ($("#pills-gunDagilimGrafik-tab").hasClass("active")) {
                $('#btnExceleAktar').hide();
                if (gunDagilim2 != null) {
                    gunDagilim2;
                }
                else {
                    gunDagilimGrafikler();
                }
            }
            else if ($("#pills-gun-tab").hasClass("active")) {
                $('#btnExceleAktar').hide();
                if (gunDagilim != null) {
                    gunDagilim;
                }
                else {
                    gunDagilimlar();
                }
            }
            else if ($("#pills-ay-tab").hasClass("active")) {
                $('#btnExceleAktar').hide();
                if (ayDagilim != null) {
                    ayDagilim;
                }
                else {
                    ayDagilimlar();
                }
            }
            else if ($("#pills-mevsim-tab").hasClass("active")) {
                $('#btnExceleAktar').hide();
                if (mevsimDagilim != null) {
                    mevsimDagilim;
                }
                else {
                    mevsimDagilimlar();
                }
            }
            else if ($("#pills-tarih-tab").hasClass("active")) {
                $('#btnExceleAktar').hide();
                if (tarihDagilim != null) {
                    tarihDagilim;
                }
                else {
                    tarihDagilimlar();
                }
            }
            else if ($("#pills-kalibrasyonluDetayli-tab").hasClass("active")) {
                $('#btnExceleAktar').hide();
                if (kalibrasyonluNobetDagilim != null) {
                    kalibrasyonluNobetDagilim;
                }
                else {
                    kalibrasyonluNobetDagilimlar();
                }
            }
            else if ($("#pills-nobetDurumlari-tab").hasClass("active")) {
                $('#btnExceleAktar').hide();
                if (nobetDurumDagilim != null) {
                    nobetDurumDagilim;
                }
                else {
                    nobetDurumTabloOlustur();
                }
            }
        });

        function chekBoxDegistir(element) {
            if (element.checked) {
                pivotAlanlariGoster = true;
            }
            else {
                pivotAlanlariGoster = false;
            }
        }

        $('#btnAlanlariGizleGosterNobetciEczaneListesi').click(function () {
            //alert(pivotAlanlariGosterNobetciListesi)
            if (pivotAlanlariGoster) {
                pivotAlanlariGoster = false;
                $('#btnTextAlanlariGizleGoster').text("Alanları Göster")
            }
            else {
                pivotAlanlariGoster = true;
                $('#btnTextAlanlariGizleGoster').text("Alanları Gizle")
            }


            //nobetciListesi();
        });

        $('#btnAlanlariGizleGostergunOzetGrafik').click(function () {
            //alert(pivotAlanlariGosterNobetciListesi)
            if (pivotAlanlariGosterGunOzetGrafik) {
                pivotAlanlariGosterGunOzetGrafik = false;
                $('#btnAlanlariGizleGostergunOzetGrafik').text("Alanları Göster")
            }
            else {
                pivotAlanlariGosterGunOzetGrafik = true;
                $('#btnAlanlariGizleGostergunOzetGrafik').text("Alanları Gizle")
            }
            gunGrafikOlustur();
        });

        $('#btnAlanlariGizleGostergunDegerDagilim').click(function () {
            //alert(pivotAlanlariGosterNobetciListesi)
            if (pivotAlanlariGosterGunDagilim) {
                pivotAlanlariGosterGunDagilim = false;
                $('#btnAlanlariGizleGostergunDegerDagilim').text("Alanları Göster")
            }
            else {
                $('#btnAlanlariGizleGostergunDegerDagilim').text("Alanları Gizle")
                pivotAlanlariGosterGunDagilim = true;
            }
            gunDagilimlar();
        });

        $('#btnAlanlariGizleGostergunDagilimGrafik').click(function () {
            //alert(pivotAlanlariGosterNobetciListesi)
            if (pivotAlanlariGosterGunDagilimGrafikler) {
                pivotAlanlariGosterGunDagilimGrafikler = false;
                $('#btnAlanlariGizleGostergunDagilimGrafik').text("Alanları Göster")
            }
            else {
                $('#btnAlanlariGizleGostergunDagilimGrafik').text("Alanları Gizle")
                pivotAlanlariGosterGunDagilimGrafikler = true;
            }
            gunDagilimGrafikler();
        });

        $('#btnAlanlariGizleGosterAylikDagilim').click(function () {
            //alert(pivotAlanlariGosterNobetciListesi)
            if (pivotAlanlariGosterAyDagilimGrafikler) {
                pivotAlanlariGosterAyDagilimGrafikler = false;
                $('#btnAlanlariGizleGosterAylikDagilim').text("Alanları Göster")
            }
            else {
                $('#btnAlanlariGizleGosterAylikDagilim').text("Alanları Gizle")
                pivotAlanlariGosterAyDagilimGrafikler = true;
            }
            ayDagilimlar();
        });

        $('#btnAlanlariGizleGosterMevsimDagilim').click(function () {
            //alert(pivotAlanlariGosterNobetciListesi)
            if (pivotAlanlariGosterMevsimDagilim) {
                pivotAlanlariGosterMevsimDagilim = false;
                $('#btnAlanlariGizleGosterMevsimDagilim').text("Alanları Göster")
            }
            else {
                $('#btnAlanlariGizleGosterMevsimDagilim').text("Alanları Gizle")
                pivotAlanlariGosterMevsimDagilim = true;
            }
            mevsimDagilimlar();
        });

        $('#btnAlanlariGizleGosterKalibrasyonluDetayli').click(function () {
            //alert(pivotAlanlariGosterNobetciListesi)
            if (pivotAlanlariGosterKalibrasyonluDetayli) {
                pivotAlanlariGosterKalibrasyonluDetayli = false;
                $('#btnAlanlariGizleGosterKalibrasyonluDetayli').text("Alanları Göster")
            }
            else {
                $('#btnAlanlariGizleGosterKalibrasyonluDetayli').text("Alanları Gizle")
                pivotAlanlariGosterKalibrasyonluDetayli = true;
            }
            kalibrasyonluNobetDagilimlar();
        });

        $('#btnAlanlariGizleGosterNobetDurumlari').click(function () {
            //alert(pivotAlanlariGosterNobetciListesi)
            if (pivotAlanlariGosterNobetDurumlari) {
                pivotAlanlariGosterNobetDurumlari = false;
                $('#btnAlanlariGizleGosterNobetDurumlari').text("Alanları Göster")
            }
            else {
                $('#btnAlanlariGizleGosterNobetDurumlari').text("Alanları Gizle")
                pivotAlanlariGosterNobetDurumlari = true;
            }
            nobetDurumTabloOlustur();
        });

        var tpl = $.pivotUtilities.aggregatorTemplates;

        var sum = tpl.sum;
        var numberFormat = $.pivotUtilities.numberFormat;
        var intFormat = numberFormat({ digitsAfterDecimal: 0 });

        var pivotAggregators = {
            //"Nöbet #": function () { return tpl.count()() }
            //"Average": function () { return tpl.average()(["Age"]) }
            "Say": $.pivotUtilities.aggregators['Say'],
            "Benzersiz Değerleri Say": $.pivotUtilities.aggregators['Benzersiz Degerleri Say'],
            "Benzersiz Değerleri Listele": $.pivotUtilities.aggregators['Benzersiz Degerleri Listele'],
            "Topla": $.pivotUtilities.aggregators['Topla'],
            "Topla (Tamsayı)": $.pivotUtilities.aggregators['Topla (Tamsayi)'],
            "Ortalama": $.pivotUtilities.aggregators['Ortalama'],
            "En Az": $.pivotUtilities.aggregators['En Az'],
            "En Fazla": $.pivotUtilities.aggregators['En Fazla'],
            "Örneklem Varyansı": $.pivotUtilities.aggregators['Orneklem Varyansi'],
            "Örneklem Standart Sapması": $.pivotUtilities.aggregators['Orneklem Standart Sapmasi'],
            "İlk": $.pivotUtilities.aggregators['Ilk'],
            "Son": $.pivotUtilities.aggregators['Son'],
            "Genel Toplam % (Topla)": $.pivotUtilities.aggregators['Genel Toplam % (Topla)'],
            "Satır Toplam % (Topla)": $.pivotUtilities.aggregators['Satir Toplam % (Topla)'],
            "Sütun Toplam % (Topla)": $.pivotUtilities.aggregators['Sutun Toplam % (Topla)'],
            "Genel Toplam % (Say)": $.pivotUtilities.aggregators['Genel Toplam % (Say)'],
            "Satır Toplam % (Say)": $.pivotUtilities.aggregators['Satir Toplam % (Say)'],
            "Sütun Toplam % (Say)": $.pivotUtilities.aggregators['Sutun Toplam % (Say)'],
        };

        var pivotRenderers = {
            "Tablo": $.pivotUtilities.renderers['Tablo'],
            "Tablo Çubuk Grafik": $.pivotUtilities.renderers['Tablo Cubuk Grafik'],
            "Sıcaklık Haritası": $.pivotUtilities.renderers['Sicaklik Haritasi'],
            "Sıcaklık Haritası (Satır)": $.pivotUtilities.renderers['Satir Sicaklik Haritasi'],
            "Sıcaklık Haritası (Sütun)": $.pivotUtilities.renderers['Sutun Sicaklik Haritasi'],
        };

        var pivotRenderersGrafik = {
            "Çubuk Grafik": $.pivotUtilities.c3_renderers['Cubuk Grafik'],
            "Yığılmış Çubuk Grafik": $.pivotUtilities.c3_renderers['Yigilmis Cubuk Grafik'],
            "Sütun Grafik": $.pivotUtilities.c3_renderers['Sutun Grafik'],
            "Yığılmış Sütun Grafik": $.pivotUtilities.c3_renderers['Yigilmis Sutun Grafik'],
            "Çizgi Grafik": $.pivotUtilities.c3_renderers['Cizgi Grafik'],
            "Yüzey Grafik": $.pivotUtilities.c3_renderers['Yuzey Grafik'],
            "Dağılım Grafiği": $.pivotUtilities.c3_renderers['Dagilim Grafigi'],
        };

        function PivotAlanlariGosterGizle(pivotAlanlariGosterGizle, divId) {
            if (pivotAlanlariGosterGizle) {
                $(divId).parent().find('.pvtAxisContainer').show();
                $(divId).parent().find('.pvtAttrDropdown').show();
                $(divId).parent().find('.pvtRenderer').show();
                $(divId).parent().find('.pvtVals').show();
            }
            else {
                $(divId).parent().find('.pvtAxisContainer').hide();
                $(divId).parent().find('.pvtAttrDropdown').hide();
                $(divId).parent().find('.pvtRenderer').hide();
                $(divId).parent().find('.pvtVals').hide();
            }
        }

        //nöbetçi eczane listesi r01
        const nobetciListesi = () => {

            //pivotAlanlariGosterNobetciListesi = pivotAlanlariGoster;
            //alert("nobetciListesi: " + dagilimlarPivot.length)

            if (dagilimlarPivot != null && dagilimlarPivot.length > 0) {
                //alert("nobetciListesi")
                //alert(nobetUstGrupId)
                var pivotCols = ["Nöbet Grubu"];

                if (nobetUstGrupId == 4) {
                    pivotCols = ["Görev Tipi"];
                }

                nobetciEczaneler = $(icRaporDivId).pivotUI(dagilimlarPivot, {
                    rows: ["Yıl-Ay", "Tarih", "Gün Grup"],
                    cols: pivotCols,
                    vals: ["Eczane"],
                    aggregatorName: "Benzersiz Değerleri Listele",
                    aggregators: pivotAggregators,
                    //rendererName: "Table",
                    renderers: pivotRenderers,
                    onRefresh: function (config) {

                        $(icRaporDivId).parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();

                        //console.log($(icRaporDivId + " #testTable tbody tr").find('.pvtVal').text());

                        $.each($(icRaporDivId + " #testTable tbody tr th"), function (key, value) {

                                //console.log($(this).text());
                            if ($(this).text().indexOf('Pazar') != -1
                                || $(this).text().indexOf('Cumartesi') != -1
                                || $(this).text().indexOf('Hafta Sonu') != -1
                            ) {
                                $(this).css('background-color', "#C3E6CB");
                            }
                            else if ($(this).text().indexOf('Bayram') != -1) {
                                $(this).css('background-color', "#F5C6CB");
                            }
                            else if ($(this).text().indexOf('Arife') != -1) {
                                $(this).css('background-color', "#FFEEBA");
                            }

                            //table-success: #C3E6CB
                            //table-info: #BEE5EB
                            //table-danger: #F5C6CB

                            //$.each(this.cells, function(k,i){
                            //    console.log(i);
                            //});

                            //console.log( key + ": " + this.find('.pvtVal').text() );
                        });

                        //if ($(icRaporDivId + " #testTable tbody tr").find('.pvtVal').text().split(": ")[1] == "istek") {
                        //    console.log($(icRaporDivId + " #testTable tbody tr").find('.pvtVal').text().split(": ")[1])
                        //    $(icRaporDivId + " #testTable tbody tr").find('.pvtVal').css('color', 'red');
                        //}
                        //alert(0)

                        if (pivotAlanlariGoster) {
                            $(icRaporDivId).parent().find('.pvtAggregator').show();
                            $(icRaporDivId).parent().find('.pvtAxisContainer').show();
                            $(icRaporDivId).parent().find('.pvtAttrDropdown').show();
                            $(icRaporDivId).parent().find('.pvtRenderer').show();
                            $(icRaporDivId).parent().find('.pvtVals').show();
                        }
                        else {
                            $(icRaporDivId).parent().find('.pvtAggregator').hide();
                            $(icRaporDivId).parent().find('.pvtAxisContainer').hide();
                            $(icRaporDivId).parent().find('.pvtAttrDropdown').hide();
                            $(icRaporDivId).parent().find('.pvtRenderer').hide();
                            $(icRaporDivId).parent().find('.pvtVals').hide();
                        }

                        //$('#raporMasterDiv .pvtAttrDropdown option').each(function () {
                        //    //$(this).hide();
                        //    if ($(this).val() != "Eczane") {
                        //        $(this).remove();
                        //    }
                        //    //else {
                        //    //    $(this).text("Liste");
                        //    //}
                        //});
                    }
                }
                    //   , false, "fr"
                );
            }
            else {
                //nobetciEczaneler;
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert(mesaj);
                //alert('Nöbetçi eczane listesi yok.');
            }
        }

        //nöbetçi eczane listesi mazeret ve istek eşli r26
        const nobetciListesiMazeretIstek = () => {

            //pivotAlanlariGosterNobetciListesi = pivotAlanlariGoster;
            //alert("nobetciListesi: " + dagilimlarPivot.length)
            if (dagilimlarPivot != null && dagilimlarPivot.length > 0) {
                //alert("nobetciListesi")
                //alert(nobetUstGrupId)
                var pivotCols = ["Nöbet Grubu"];

                if (nobetUstGrupId == 4) {
                    pivotCols = ["Görev Tipi"];
                }

                nobetciEczanelerMazeretIstek = $(icRaporDivId).pivotUI(dagilimlarPivot, {
                    rows: ["Yıl-Ay", "Tarih", "Gün Grup"],
                    cols: pivotCols,
                    vals: ["Eczane Sonuç"],
                    aggregatorName: "Benzersiz Değerleri Listele",
                    aggregators: pivotAggregators,
                    //rendererName: "Table",
                    renderers: pivotRenderers,
                    onRefresh: function (config) {

                        $(icRaporDivId).parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();

                        //console.log($(icRaporDivId + " #testTable tbody tr").find('.pvtVal').text());

                        $.each($(icRaporDivId + " #testTable tbody tr td"), function (key, value) {

                                //console.log($(this).text());
                            if ($(this).text().indexOf('istek') != -1) {
                                $(this).css('background-color', "#C3E6CB");
                            }
                            else if ($(this).text().indexOf('mazeret') != -1) {
                                $(this).css('background-color', "#F5C6CB");
                            }

                            //table-success: #C3E6CB
                            //table-info: #BEE5EB
                            //table-danger: #F5C6CB

                            //$.each(this.cells, function(k,i){
                            //    console.log(i);
                            //});

                          //console.log( key + ": " + this.find('.pvtVal').text() );
                        });

                        //if ($(icRaporDivId + " #testTable tbody tr").find('.pvtVal').text().split(": ")[1] == "istek") {
                        //    console.log($(icRaporDivId + " #testTable tbody tr").find('.pvtVal').text().split(": ")[1])
                        //    $(icRaporDivId + " #testTable tbody tr").find('.pvtVal').css('color', 'red');
                        //}
                        //alert(0)

                        if (pivotAlanlariGoster == false) {
                            $(icRaporDivId).parent().find('.pvtAggregator').hide();
                            $(icRaporDivId).parent().find('.pvtAxisContainer').hide();
                            $(icRaporDivId).parent().find('.pvtAttrDropdown').hide();
                            $(icRaporDivId).parent().find('.pvtRenderer').hide();
                            $(icRaporDivId).parent().find('.pvtVals').hide();
                        }
                        else {
                            $(icRaporDivId).parent().find('.pvtAggregator').show();
                            $(icRaporDivId).parent().find('.pvtAxisContainer').show();
                            $(icRaporDivId).parent().find('.pvtAttrDropdown').show();
                            $(icRaporDivId).parent().find('.pvtRenderer').show();
                            $(icRaporDivId).parent().find('.pvtVals').show();
                        }

                        //$('#raporMasterDiv .pvtAttrDropdown option').each(function () {
                        //    //$(this).hide();
                        //    if ($(this).val() != "Eczane") {
                        //        $(this).remove();
                        //    }
                        //    //else {
                        //    //    $(this).text("Liste");
                        //    //}
                        //});
                    }
                }
                    //   , false, "fr"
                );
            }
            else {
                //nobetciEczaneler;
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert(mesaj);
                //alert('Nöbetçi eczane listesi yok.');
            }
        }

        $('#pills-nobetci-tab').click(function (e) {

            $('#btnExceleAktar').show();

            if (nobetGrubu.length == 0) {
                alert("Nöbet grubu seçiniz..")
                e.preventDefault();
            }
            else {
                //alert(1)
                var urlDagilimlar = '@Url.Action("GetSonuclar")';
                var serializedForm = $('#formTumu').serialize();
                dagilimlar = null;
                dagilimlarTumu = null;
                dagilimlarPivot = new Array();
                //dagilimlarFiltreli = null;
                //nobetciEczaneler = null;

                if (nobetciEczaneler != null) {
                    nobetciEczaneler;
                }
                else {
                    nobetciListesi();
                }
            }

        });

        //gün dağılım r02
        function gunDagilimlar() {

            if (dagilimlarPivot != null && dagilimlarPivot.length > 0) {

                var pivotRows = ["Nöbet Grubu", "Eczane"];
                var pivotCols = ["Gün Grup"];
                var pivotRendererName = "Sıcaklık Haritası";

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Eczane"];
                    pivotCols = ["Görev Tipi", "Gün Grup"];
                }
                else if (nobetUstGrupId == 5) {
                    pivotRows = ["Eczane"];
                    pivotCols = ["Gün Grup"];
                    pivotRendererName = "Sıcaklık Haritası (Sütun)"
                }
                //alert("gunDagilimlar" + dagilimlarPivot.length)

                //alert("gunDagilim: " + gunDagilim.legnt)

                gunDagilim = $(function table2() {

                    $(icRaporDivId).pivotUI(dagilimlarPivot,
                        {
                            rows: pivotRows,
                            cols: pivotCols, //, "GunDeger", "GunTanim"
                            vals: ["Eczane"],
                            aggregatorName: "Say",
                            aggregators: pivotAggregators,
                            renderers: pivotRenderers,
                            rendererName: pivotRendererName,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );

                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Gün dağılımı listesi yok.');
            }
        }

        $('#pills-gun-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (gunDagilim != null) {
                gunDagilim;
            }
            else {
                gunDagilimlar();
            }
        });

        //bayramlar r27
        function gunDagilimlarBayramlar() {

            //alert(gunDagilimlarBayramlar)

            if (dagilimlarPivot != null && dagilimlarPivot.length > 0) {

                //var bayramlar = $.grep(dagilimlarPivot, function (n, i) {
                //    return n["Gün Grup"] == "Bayram";
                //});

                var pivotRows = ["Nöbet Grubu", "Eczane"];
                var pivotCols = ["Gün Tanım", "Özel Gün",];
                var pivotRendererName = "Sıcaklık Haritası";
                var pivotAggregatorName = "Say";
                var pivotVals = ["Eczane"];

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Görev Tipi", "Eczane"];
                    pivotCols = ["Gün Tanım", "Özel Gün",];
                }
                else if (nobetUstGrupId == 5) {
                    pivotRows = ["Eczane"];
                    pivotCols = ["Gün Tanım", "Özel Gün", "Özel Gün Ktg."];
                    pivotRendererName = "Sıcaklık Haritası"
                    pivotAggregatorName = "Topla (Tamsayı)";
                    pivotVals = ["Gün Ağırlık"];
                }
                //alert("gunDagilimlar" + dagilimlarPivot.length)

                //alert("gunDagilim: " + gunDagilim.legnt)

                gunDagilimBayramlar = $(function table2() {

                    $(icRaporDivId).pivotUI(dagilimlarPivot,
                        {
                            rows: pivotRows,
                            cols: pivotCols, //, "GunDeger", "GunTanim"
                            vals: pivotVals,
                            aggregatorName: pivotAggregatorName,
                            aggregators: pivotAggregators,
                            renderers: pivotRenderers,
                            rendererName: pivotRendererName,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );

                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Gün dağılımı listesi yok.');
            }
        }

        //hafta içi r28
        function gunDagilimlarHaftaIci() {

            if (dagilimlarPivot != null && dagilimlarPivot.length > 0) {

                var pivotRows = ["Nöbet Grubu", "Eczane"];
                var pivotCols = ["Gün Grup", "Gün Tanım"];
                var pivotRendererName = "Sıcaklık Haritası";

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Eczane"];
                    pivotCols = ["Görev Tipi", "Gün Grup", "Gün Tanım"];
                }
                else if (nobetUstGrupId == 5) {
                    pivotRows = ["Eczane"];
                    pivotCols = ["Gün Grup", "Gün Tanım"];
                    pivotRendererName = "Sıcaklık Haritası (Sütun)"
                }
                //alert("gunDagilimlar" + dagilimlarPivot.length)

                //alert("gunDagilim: " + gunDagilim.legnt)

                gunDagilimHaftaIci = $(function table2() {

                    $(icRaporDivId).pivotUI(dagilimlarPivot,
                        {
                            rows: pivotRows,
                            cols: pivotCols, //, "GunDeger", "GunTanim"
                            vals: ["Eczane"],
                            aggregatorName: "Say",
                            aggregators: pivotAggregators,
                            renderers: pivotRenderers,
                            rendererName: pivotRendererName,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );

                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Gün dağılımı listesi yok.');
            }
        }

        //gün dağılım grafik r03
        var gunGrafik2;
        function gunDagilimGrafikler() {
            if (dagilimlarPivot != null && dagilimlarPivot.length > 0) {

                var pivotRows = ["Gün Grup"];
                var pivotCols = ["NöbetGrupGörevTipId", "Eczane"];

                if (nobetUstGrupId == 5 // osmaniye
                    || nobetUstGrupId == 6//bartın
                    || nobetUstGrupId == 9//çorum
                ) {
                    pivotCols = ["Eczane"];
                }

                gunGrafik2 = $(function table2() {
                    $(icRaporDivId).pivotUI(dagilimlarPivot,
                        {
                            rows: pivotRows,
                            cols: pivotCols, //, "GunDeger", "GunTanim"
                            vals: ["Eczane"],
                            aggregatorName: "Say",
                            aggregators: pivotAggregators,
                            rendererName: "Yığılmış Sütun Grafik",
                            renderers: $.extend(
                                pivotRenderers,
                                pivotRenderersGrafik
                            ),
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });

            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Gün dağılımı listesi yok.');
            }
        }
        $('#pills-gunDagilimGrafik-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (gunGrafik2 != null) {
                gunGrafik2;
            }
            else {
                gunDagilimGrafikler();
            }
        });

        //gün dağılım grafik - özet grafik - max min - Nöbet Farkı r07
        var gunGrafik;
        function gunGrafikOlustur() {
            if (gunDagilimiMaxMin != null && gunDagilimiMaxMin.length > 0) {
                gunGrafik = $(function table2() {
                    $(icRaporDivId).pivotUI(gunDagilimiMaxMin,
                        {
                            rows: ["Gün Grup"],
                            cols: ["Nöbet Grubu"], //, "GunDeger", "GunTanim"
                            vals: ["Nöbet Sayısı Farkı"],
                            aggregatorName: "Topla (Tamsayı)",
                            aggregators: pivotAggregators,
                            rendererName: "Yığılmış Sütun Grafik",
                            renderers: $.extend(
                                pivotRenderers,
                                pivotRenderersGrafik
                            ),
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Gün dağılımı listesi yok.');
            }
        }
        $('#pills-gunOzetGrafik-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (gunGrafik != null) {
                gunGrafik;
            }
            else {
                gunGrafikOlustur();
            }
        });

        //ay dağılım r04
        var ayDagilim;
        function ayDagilimlar() {
            if (dagilimlarPivot != null && dagilimlarPivot.length > 0) {

                var pivotRows = ["Nöbet Grubu", "Eczane"];
                var pivotCols = ["Yıl-Ay"];

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Görev Tipi", "Eczane"];
                }
                else if (nobetUstGrupId == 5) {
                    pivotRows = ["Eczane"];
                }

                ayDagilim = $(function table3() {
                    $(icRaporDivId).pivotUI(dagilimlarPivot,
                        {
                            rows: pivotRows,
                            cols: pivotCols,
                            vals: ["Nöbet Grubu"],
                            aggregatorName: "Say",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });

            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Ay dağılımı listesi yok.');
            }
        }
        $('#pills-ay-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (ayDagilim != null) {
                ayDagilim;
            }
            else {
                ayDagilimlar();
            }
        });

        //mevsim dağılım r05
        var mevsimDagilim;
        function mevsimDagilimlar() {
            if (dagilimlarPivot != null && dagilimlarPivot.length > 0) {

                var pivotRows = ["Nöbet Grubu", "Eczane"];
                var pivotCols = ["Gün Grup", "Mevsim"];

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Görev Tipi", "Eczane"];
                    //pivotCols = ["Gün Grup", "Mevsim"];
                }
                else if (nobetUstGrupId == 5) {
                    pivotRows = ["Eczane"];
                }

                mevsimDagilim = $(function table3() {
                    $(icRaporDivId).pivotUI(dagilimlarPivot,
                        {
                            rows: pivotRows,
                            cols: pivotCols,
                            vals: ["Eczane"],
                            aggregatorName: "Say",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });

            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Ay dağılımı listesi yok.');
            }
        }
        $('#pills-mevsim-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (mevsimDagilim != null) {
                mevsimDagilim;
            }
            else {
                mevsimDagilimlar();
            }
        });

        //ikili aylar dağılım r29
        function ikiliAyDagilimlar() {
            //alert("ikiliAyDagilimlar")
            if (dagilimlarPivot != null && dagilimlarPivot.length > 0) {

                var pivotRows = ["Nöbet Grubu", "Eczane"];
                var pivotCols = ["Gün Grup", "Ay İkili"];

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Görev Tipi", "Eczane"];
                    //pivotCols = ["Gün Grup", "Mevsim"];
                }
                else if (nobetUstGrupId == 5) {
                    pivotRows = ["Eczane"];
                }

                ikiliAyDagilim = $(function table3() {
                    $(icRaporDivId).pivotUI(dagilimlarPivot,
                        {
                            rows: pivotRows,
                            cols: pivotCols,
                            vals: ["Eczane"],
                            aggregatorName: "Say",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });

            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Ay dağılımı listesi yok.');
            }
        }

        //tarih dağılım r06
        var tarihDagilim;
        function tarihDagilimlar() {
            if (dagilimlarPivot != null && dagilimlarPivot.length > 0) {

                var pivotRows = ["Nöbet Grubu", "Eczane"];
                var pivotCols = ["Yıl-Ay", "Tarih"];

                //alert(nobetGrubu.length)
                //if (nobetGrubu.length == 1) {
                //    pivotRows = ["Eczane"];
                //}
                if (nobetUstGrupId == 4) {
                    pivotRows = ["Görev Tipi", "Eczane"];
                    //pivotCols = ["Gün Grup", "Mevsim"];
                }
                //else if (nobetUstGrupId == 5) {
                //    pivotRows = ["Nöbet Grubu", "Eczane"];
                //}

                tarihDagilim = $(function table4() {
                    $(icRaporDivId).pivotUI(dagilimlarPivot,
                        {
                            rows: pivotRows,
                            cols: pivotCols,
                            vals: ["Nöbet Grubu"],
                            aggregatorName: "Say",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });

            }
            else {
                $('#tarihVeriSinirUyari').hide();
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Tarih dağılımı listesi yok.');
            }
        }
        $('#pills-tarih-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (tarihDagilim != null) {
                tarihDagilim;
            }
            else {
                tarihDagilimlar();
            }
        });

        //kalibrasyonlu nöbet dağılımı r24
        var kalibrasyonluNobetDagilim;
        function kalibrasyonluNobetDagilimlar() {
            if (kalibrasyonEslemeliNobetler.length > 0) {
                kalibrasyonluNobetDagilim = $(function table8() {
                    $(icRaporDivId).pivotUI(kalibrasyonEslemeliNobetler,
                        {
                            rows: ["EczaneAdi"],
                            cols: ["GunGrupAdi", "Durum", "KalibrasyonTipAdi"],
                            vals: ["Deger"],
                            aggregatorName: "Topla (Tamsayı)",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası (Sütun)",
                            renderers: $.extend(
                                pivotRenderers,
                                pivotRenderersGrafik
                            ),
                            onRefresh: function (config) {
                                $(icRaporDivId).parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                $("#listeVeriUayri").html(uyariMesaj);
                $("#listeVeriUayri").append(" (Kalibrasyon dağılım listesi yok.)");
                $("#listeVeriUayri").show();
                //alert('Aynı gün dağılım listesi yok.');
            }
        }
        $('#pills-kalibrasyonluNobet-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (kalibrasyonluNobetDagilim != null) {
                kalibrasyonluNobetDagilim;
            }
            else {
                kalibrasyonluNobetDagilimlar();
            }
        });

        //nöbet durumları r25
        var nobetDurumDagilim;
        function nobetDurumTabloOlustur() {
            if (dagilimlarPivot != null && dagilimlarPivot.length > 0) {
                nobetDurumDagilim = $(function table3() {
                    $(icRaporDivId).pivotUI(dagilimlarPivot,
                        {
                            rows: ["Alt Grup Adı", "Eczane"],
                            cols: ["Gün Grup", "Nöbet Durum Tipi"],
                            vals: ["Nöbet Grubu"],
                            aggregatorName: "Satır Toplam % (Say)",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariNobetDurum';
                var parentDivId = 'nobetDurumlar';
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Ay dağılımı listesi yok.');
            }
        }
        $('#pills-nobetDurumlari-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (nobetDurumDagilim != null) {
                nobetDurumDagilim;
            }
            else {
                nobetDurumTabloOlustur();
            }
        });
    </script>
    <!-- #endregion -->
    <!-- #region gün farkı -->
    <script type="text/javascript">
        //setTimeout(function () { $('.alert').fadeOut(500); }, 3000);

        $('#pills-gunFarki-tab').click(function () {
            $('#btnExceleAktar').hide();
            $('#inputTarihAralik').hide();

            if ($("#pills-gunFarkiGrafik-tab").hasClass("active")) {
                //alert(1)
                if (gunFarkiGrafikVeri != null) {

                    gunFarkiGrafikVeri;
                }
                else {
                    gunFarkiGrafik();
                }
            }
            else if ($("#pills-ozet-tab").hasClass("active")) {
                //alert(1)
                if (gunFarkiOzetListesi != null) {

                    gunFarkiOzetListesi;
                }
                else {
                    gunFarkiOzet();
                }
            }
            else if ($("#pills-frekans-tab").hasClass("active")) {
                if (gunFarkiFrekansListesi != null) {

                    gunFarkiFrekansListesi;
                }
                else {
                    gunFarkiFrekans();
                }
            }
            else if ($("#pills-dongu-tab").hasClass("active")) {
                if (gunFarkiDonguListesi != null) {

                    gunFarkiDonguListesi;
                }
                else {
                    donguler();
                }
            }
            else if ($("#pills-detayliArtan-tab").hasClass("active")) {
                if (gunFarkiDetayliArtanListesi != null) {

                    gunFarkiDetayliArtanListesi;
                }
                else {
                    gunFarkiDetayliArtanlar();
                }
            }
            else if ($("#pills-detayliAzalan-tab").hasClass("active")) {
                if (gunFarkiDetayliAzalanListesi != null) {

                    gunFarkiDetayliAzalanListesi;
                }
                else {
                    gunFarkiDetayliAzalanlar();
                }
            }
        });

        //maks, min, ort., std sap. vb. r08

        var gunFarkiGrafikVeri;
        function gunFarkiGrafik() {
            if (gunFarklariFrekanslar != null && gunFarklariFrekanslar.length > 0) {
                //alert(1)
                var pivotRows = ["Gün Grup"];
                var pivotCols = ["Nöbet Grubu"];

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Görev Tipi"];
                    //pivotCols = ["Gün Grup", "Mevsim"];
                }
                //else if (nobetUstGrupId == 5) {
                //    pivotRows = ["Nöbet Grubu", "Eczane"];
                //}

                gunFarkiGrafikVeri = $(function table5() {
                    $(icRaporDivId).pivotUI(gunFarklariFrekanslar,
                        {
                            rows: pivotRows,
                            cols: pivotCols,
                            vals: ["Gün Farkı"],
                            aggregatorName: "En Fazla",
                            aggregators: pivotAggregators,
                            rendererName: "Yığılmış Sütun Grafik",
                            renderers: $.extend(
                                pivotRenderers,
                                pivotRenderersGrafik
                            ),
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        });
                });

            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Gün farkı özet listesi yok.');
            }
        }
        $('#pills-gunFarkiGrafik-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (gunFarkiGrafikVeri != null) {
                gunFarkiGrafikVeri;
            }
            else {
                gunFarkiGrafik();
            }
        });

        //r09
        var gunFarkiOzetListesi;
        function gunFarkiOzet() {
            if (gunFarklariFrekanslar != null && gunFarklariFrekanslar.length > 0) {

                var pivotRows = ["Nöbet Grubu"];
                var pivotCols = ["Gün Grup"];

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Görev Tipi"];
                    //pivotCols = ["Gün Grup", "Mevsim"];
                }
                //else if (nobetUstGrupId == 5) {
                //    pivotRows = ["Nöbet Grubu", "Eczane"];
                //}

                gunFarkiOzetListesi = $(function table1() {
                    $(icRaporDivId).pivotUI(gunFarklariFrekanslar,
                        {
                            rows: pivotRows,
                            cols: pivotCols,
                            vals: ["Gün Farkı"],
                            aggregatorName: "En Fazla",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        });
                });

            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Gün farkı özet listesi yok.');
            }
        }
        $('#pills-ozet-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (gunFarkiOzetListesi != null) {

                gunFarkiOzetListesi;
            }
            else {
                gunFarkiOzet();
            }
        });

        //frekans r10
        var gunFarkiFrekansListesi;
        function gunFarkiFrekans() {
            if (gunFarklariFrekanslar != null && gunFarklariFrekanslar.length > 0) {

                var pivotRows = ["Gün Grup", "Nöbet Grubu"];
                var pivotCols = ["Ay Farkı", "Hafta Farkı"];

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Görev Tipi", "Gün Grup", "Nöbet Grubu"];
                    //pivotCols = ["Gün Grup", "Mevsim"];
                }

                gunFarkiFrekansListesi = $(function table2() {
                    $(icRaporDivId).pivotUI(gunFarklariFrekanslar,
                        {
                            rows: pivotRows,
                            cols: pivotCols,
                            vals: ["Eczane Sayısı"],
                            aggregatorName: "Topla (Tamsayı)",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Gün farkı frekans listesi yok.');
            }
        }
        $('#pills-frekans-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (gunFarkiFrekansListesi != null) {

                gunFarkiFrekansListesi;
            }
            else {
                gunFarkiFrekans();
            }
        });

        //döngü r11
        var gunFarkiDonguListesi;
        function donguler() {
            if (gunFarklariTumSonuclar != null && gunFarklariTumSonuclar.length > 0) {

                var pivotRows = ["Nöbet Grubu", "Gün Grup", "Index"];
                var pivotCols = ["N1Yıl", "N1Ay"];

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Görev Tipi", "Nöbet Grubu", "Gün Grup", "Index"];
                    //pivotCols = ["Gün Grup", "Mevsim"];
                }

                gunFarkiDonguListesi = $(function table5() {
                    $(icRaporDivId).pivotUI(gunFarklariTumSonuclar,
                        {
                            rows: pivotRows,
                            cols: pivotCols,
                            vals: ["Gün Farkı"],
                            aggregatorName: "Say",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });

            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Döngü listesi yok.');
            }
        }
        $('#pills-dongu-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (gunFarkiDonguListesi != null) {

                gunFarkiDonguListesi;
            }
            else {
                donguler();
            }
        });

        //detaylı artan r12
        var gunFarkiDetayliArtanListesi;
        function gunFarkiDetayliArtanlar() {
            if (gunFarklariTumSonuclar != null && gunFarklariTumSonuclar.length > 0) {

                var pivotRows = ["Nöbet Grubu", "Nöbet1", "Nöbet2", "Index", "Eczane"];
                var pivotCols = ["Gün Grup"];

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Görev Tipi", "Nöbet Grubu", "Nöbet1", "Nöbet2", "Index", "Eczane"];
                    //pivotCols = ["Gün Grup", "Mevsim"];
                }

                gunFarkiDetayliArtanListesi = $(function table3() {
                    $(icRaporDivId).pivotUI(gunFarklariTumSonuclar,
                        {
                            rows: pivotRows,
                            cols: pivotCols,
                            vals: ["Gün Farkı"],
                            aggregatorName: "Topla (Tamsayı)",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });

            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Gün farkı detaylı-artan liste yok.');
            }
        }
        $('#pills-detayliArtan-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (gunFarkiDetayliArtanListesi != null) {

                gunFarkiDetayliArtanListesi;
            }
            else {
                gunFarkiDetayliArtanlar();
            }
        });

        //detaylı azalan r13
        var gunFarkiDetayliAzalanListesi;
        function gunFarkiDetayliAzalanlar() {
            if (gunFarklariTumSonuclar != null && gunFarklariTumSonuclar.length > 0) {

                var pivotRows = ["Nöbet Grubu", "Nöbet2", "Nöbet1", "Index", "Eczane"];
                var pivotCols = ["Gün Grup"];

                if (nobetUstGrupId == 4) {
                    pivotRows = ["Görev Tipi", "Nöbet Grubu", "Nöbet2", "Nöbet1", "Index", "Eczane"];
                    //pivotCols = ["Gün Grup", "Mevsim"];
                }

                gunFarkiDetayliAzalanListesi = $(function table4() {
                    $(icRaporDivId).pivotUI(gunFarklariTumSonuclar,
                        {
                            rows: pivotRows,
                            cols: pivotCols,
                            vals: ["Gün Farkı"],
                            aggregatorName: "Topla (Tamsayı)",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert('Gün farkı detaylı-azalan liste yok.');
            }
        }
        $('#pills-detayliAzalan-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (gunFarkiDetayliAzalanListesi != null) {

                gunFarkiDetayliAzalanListesi;
            }
            else {
                gunFarkiDetayliAzalanlar();
            }
        });

    </script>
    <!-- #endregion -->
    <!-- #region nöbet borç ödeme -->
    <script type="text/javascript">

        $('#pills-nobetBorc-tab').click(function () {
            $('#btnExceleAktar').hide();
            $('#inputTarihAralik').hide();

            if ($("#pills-alacakVerecekGrafik-tab").hasClass("active")) {
                //alert(1)
                if (alacakVerecekGrafikVeri != null) {
                    //$("#alacakVerecekGrafik").hide();
                    //alert(1)
                    alacakVerecekGrafikVeri;
                }
                else {
                    alacakVerecekGrafik();
                }
            }
            else if ($("#pills-alacakVerecek-tab").hasClass("active")) {
                if (alacakVereceklerOzet != null) {
                    $("#divAlacakVerecekler").hide();
                    alacakVereceklerOzet;
                }
                else {
                    alacakVerecekOzet();
                }
            }
            else if ($("#pills-alacakVerecekListesi-tab").hasClass("active")) {
                if (alacakVereceklerList != null) {
                    $("#divAlacakVereceklerListe").hide();
                    alacakVereceklerList;
                }
                else {
                    alacakVerecekListe();
                }
            }
            else if ($("#pills-planlananVsGerceklesen-tab").hasClass("active")) {
                if (planlananVeGerceklesenNobetListesi != null) {
                    //$("#divAlacakVereceklerListe").hide();
                    planlananVeGerceklesenNobetListesi;
                }
                else {
                    planlananVeGerceklesenNobetler();
                }
            }
        });

        $('#btnAlanlariGizleGosterPlanlananVsGerceklesen').click(function () {
            //alert(pivotAlanlariGosterNobetciListesi)
            if (pivotAlanlariGosterPlanlanaGerceklesen) {
                pivotAlanlariGosterPlanlanaGerceklesen = false;
                $('#btnAlanlariGizleGosterPlanlananVsGerceklesen').text("Alanları Göster")
            }
            else {
                pivotAlanlariGosterPlanlanaGerceklesen = true;
                $('#btnAlanlariGizleGosterPlanlananVsGerceklesen').text("Alanları Gizle")
            }
            planlananVeGerceklesenNobetler();
        });

        //alacakVerecek grafik r14
        var alacakVerecekGrafikVeri;

        function alacakVerecekGrafik() {
            if (alacakVerecekLitesi != null && alacakVerecekLitesi.length > 0) {

                alacakVerecekGrafikVeri = $(function table7() {
                    $(icRaporDivId).pivotUI(alacakVerecekLitesi,
                        {
                            rows: ["Gün Grup"],
                            cols: ["BorçluGünSayısı"],
                            vals: ["BorçluGünSayısı"],
                            aggregatorName: "Say",
                            aggregators: pivotAggregators,
                            rendererName: "Yığılmış Sütun Grafik",
                            renderers: $.extend(
                                pivotRenderers,
                                pivotRenderersGrafik
                            ),
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert(mesaj);
            }
        }
        $('#pills-alacakVerecekGrafik-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (alacakVerecekGrafikVeri != null) {
                //$("#alacakVerecekGrafik").hide();
                alacakVerecekGrafikVeri;
            }
            else {
                alacakVerecekGrafik();
            }
        });

        //alacakVerecek özet r15
        var alacakVereceklerOzet;
        function alacakVerecekOzet() {
            if (alacakVerecekLitesi != null && alacakVerecekLitesi.length > 0) {

                alacakVereceklerOzet = $(function table6() {
                    $(icRaporDivId).pivotUI(alacakVerecekLitesi,
                        {
                            rows: ["Nöbet Grubu"],
                            cols: ["Gün Grup", "BorçluGünSayısı"],
                            vals: ["BorçluGünSayısı"],
                            aggregatorName: "Say",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: $.extend(
                                pivotRenderers,
                                pivotRenderersGrafik
                            ),
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert(mesaj);
            }
        }
        $('#pills-alacakVerecek-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (alacakVereceklerOzet != null) {
                $("#divAlacakVerecekler").hide();
                alacakVereceklerOzet;
            }
            else {
                alacakVerecekOzet();
            }
        });

        //alacakVerecek liste r16
        var alacakVereceklerList;

        function alacakVerecekListe() {

            if (alacakVerecekLitesi != null && alacakVerecekLitesi.length > 0) {

                alacakVereceklerList = $(function table7() {
                    $(icRaporDivId).pivotUI(alacakVerecekLitesi,
                        {
                            rows: ["Gün Grup", "Nöbet Grubu", "AnahtarTarih", "Eczane", "SonNöbetTarihi", "NöbetSayısı", "Borç Durumu"],
                            //cols: ["Gün Grup"],
                            vals: ["BorçluGünSayısı"],
                            aggregatorName: "Topla (Tamsayı)",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert(mesaj);
            }
        }
        $('#pills-alacakVerecekListesi-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (alacakVereceklerList != null) {
                $("#divAlacakVereceklerListe").hide();
                alacakVereceklerList;
            }
            else {
                alacakVerecekListe();
            }
        });

        //r17
        var planlananVeGerceklesenNobetListesi;

        const planlananVeGerceklesenNobetler = () => {

            //alert("planlananVeGerceklesenNobetler")

            //pivotAlanlariGosterNobetciListesi = pivotAlanlariGoster;
            if (dagilimlarPlanlananGerceklesen != null && dagilimlarPlanlananGerceklesen.length > 0) {
                //alert("nobetciListesi")
                //alert(nobetUstGrupId)
                var pivotCols = ["Sonuç Türü"];

                if (nobetUstGrupId == 4) {
                    pivotCols = ["Görev Tipi"];
                }

                planlananVeGerceklesenNobetListesi = $(icRaporDivId).pivotUI(dagilimlarPlanlananGerceklesen, {
                    rows: ["Nöbet Grubu", "Gün Grup", "Yıl-Ay", "Eczane"],
                    cols: pivotCols,
                    vals: ["Tarih"],
                    aggregatorName: "Benzersiz Değerleri Listele",
                    aggregators: pivotAggregators,
                    //rendererName: "Table",
                    renderers: pivotRenderers,
                    onRefresh: function (config) {
                        $(icRaporDivId).parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                        //alert(0)
                        //pivotAlanlariGosterPlanlanaGerceklesen = true;
                        PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)

                        //$('#raporMasterDiv .pvtAttrDropdown option').each(function () {
                        //    //$(this).hide();
                        //    if ($(this).val() != "Eczane") {
                        //        $(this).remove();
                        //    }
                        //    //else {
                        //    //    $(this).text("Liste");
                        //    //}
                        //});
                    }
                }
                    //   , false, "fr"
                );
            }
            else {
                //nobetciEczaneler;
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert(mesaj);
                //alert('Nöbetçi eczane listesi yok.');
            }
        }
        $('#pills-planlananVsGerceklesen-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (planlananVeGerceklesenNobetListesi != null) {
                planlananVeGerceklesenNobetListesi;
            }
            else {
                planlananVeGerceklesenNobetler();
            }
        });
    </script>
    <!-- #endregion -->
    <!-- #region alt grup -->
    <script type="text/javascript">
        //aynı gün nöbet

        //var ayniGunNobetTutanEczaneler = dagilimlar.AltGrupAyniGunNobetTutanEczaneler;
        //var altGrupAyniGunNobetTutanEczaneler = dagilimlar.AltGrupAyniGunNobetTutanEczaneler;
        //aynı gün nöbet tutanlar

        $('#pills-altGrupTakip-tab').click(function () {
            $('#btnExceleAktar').hide();
            $('#inputTarihAralik').hide();

            if ($("#pills-altGrup-tab").hasClass("active")) {
                //alert(1)
                if (altGrupDagilim != null) {
                    altGrupDagilim;
                }
                else {
                    altGrupDagilimlar();
                }
            }
            else if ($("#pills-altGrupGunGrupDagilim-tab").hasClass("active")) {
                //alert(1)
                if (altGrupGunGrup != null) {
                    altGrupGunGrup;
                }
                else {
                    altGrupGunGrupDagilimlar();
                }
            }
            else if ($("#pills-altGrupSirali-tab").hasClass("active")) {
                //alert(1)
                if (altGrupSirali != null) {
                    altGrupSirali;
                }
                else {
                    altGrupSiraliDagilimlar();
                }
            }
        });

        //alt grup r18
        var altGrupDagilim;
        function altGrupDagilimlar() {

            //alert("altGrupAyniGunNobetTutanEczaneler.length: " + altGrupAyniGunNobetTutanEczaneler.length)

            if (altGrupAyniGunNobetTutanEczaneler.length > 0) {
                //alert(4)
                altGrupDagilim = $(function table8() {
                    $(icRaporDivId).pivotUI(altGrupAyniGunNobetTutanEczaneler,
                        {
                            rows: ["Grup", "G1Eczane"],
                            cols: ["AltGrup"],
                            vals: ["AltGrup"],
                            aggregatorName: "Say",
                            aggregators: pivotAggregators,
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert(mesaj);
            }
        }
        $('#pills-altGrup-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (altGrupDagilim != null) {
                altGrupDagilim;
            }
            else {
                altGrupDagilimlar();
            }
        });

        //alt grup gün grup dağılım r19
        var altGrupGunGrup;
        function altGrupGunGrupDagilimlar() {
            if (altGrupSiraliAyniGunNobetTutanEczaneler.length > 0) {
                //alert(2)
                altGrupGunGrup = $(function table8() {
                    $(icRaporDivId).pivotUI(altGrupSiraliAyniGunNobetTutanEczaneler,
                        {
                            rows: ["Grup", "G1Eczane"],
                            cols: ["Gün Grup", "AltGrup"],
                            vals: ["AltGrup"],
                            aggregatorName: "Say",
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);
                //alert(mesaj);
            }
        }
        $('#pills-altGrupGunGrupDagilim-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (altGrupGunGrup != null) {
                altGrupGunGrup;
            }
            else {
                altGrupGunGrupDagilimlar();
            }
        });

        //alt grup sıralı r20
        var altGrupSirali;
        function altGrupSiraliDagilimlar() {
            if (altGrupSiraliAyniGunNobetTutanEczaneler.length > 0) {
                altGrupSirali = $(function table8() {
                    $(icRaporDivId).pivotUI(altGrupSiraliAyniGunNobetTutanEczaneler,
                        {
                            rows: ["Grup", "G1Eczane", "Gün Grup", "Tarih"],
                            cols: ["AltGrup"],
                            vals: ["AltGrup"],
                            aggregatorName: "Say",
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);

                //alert(mesaj);
            }
        }
        $('#pills-altGrupSirali-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (altGrupSirali != null) {
                altGrupSirali;
            }
            else {
                altGrupSiraliDagilimlar();
            }
        });
    </script>
    <!-- #endregion -->
    <!-- #region aynı gün nöbet -->
    <script type="text/javascript">
        $('#pills-ayniGuneYazilanlar-tab').click(function () {
            $('#btnExceleAktar').hide();
            $('#inputTarihAralik').hide();
            //alert(1)
            if ($("#pills-ayniGunTumu-tab").hasClass("active")) {
                $('#btnExceleAktar').hide();
                if (ayniGunDagilim != null) {
                    //alert(1)
                    ayniGunDagilim;
                }
                else {
                    //alert(2)
                    ayniGunDagilimlar();
                }
            }
            else if ($("#pills-ayniGunTumuTablo-tab").hasClass("active")) {
                $('#btnExceleAktar').hide();
                if (ayniGunDagilimTablo != null) {
                    ayniGunDagilimTablo;
                }
                else {
                    ayniGunDagilimlarTablo();
                }
            }
        });

        //aynı gün nöbet dağılımı grafik r21
        var ayniGunDagilimTablo;
        function ayniGunDagilimlarTablo() {
            //alert(3)
            if (ayniGunNobetTutanEczaneler.length > 0) {
                ayniGunDagilimTablo = $(function table8() {
                    $(icRaporDivId).pivotUI(ayniGunNobetTutanEczaneler,
                        {
                            rows: ["G1Eczane", "G2Eczane"],//"G2 Nöbet Grubu",
                            cols: ["Yıl-Ay"],
                            vals: ["Aynı Gün Nöbet Sayısı"],
                            aggregatorName: "Say",
                            rendererName: "Sıcaklık Haritası",
                            renderers: pivotRenderers,
                            //renderers: $.extend(
                            //    $.pivotUtilities.renderers,
                            //    $.pivotUtilities.c3_renderers
                            //)
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                $("#listeVeriUayri").html(uyariMesaj);
                $("#listeVeriUayri").append(" (Aynı gün dağılım listesi yok.)");
                $("#listeVeriUayri").show();
                //alert('Aynı gün dağılım listesi yok.');
            }
        }
        $('#pills-ayniGunTumuTablo-tab').click(function () {
            //alert(1)
            $('#btnExceleAktar').hide();
            if (ayniGunDagilimTablo != null) {
                ayniGunDagilimTablo;
            }
            else {
                ayniGunDagilimlarTablo();
            }
        });

        //aynı gün nöbet dağılımı grafik r22
        var ayniGunDagilim;
        function ayniGunDagilimlar() {
            //alert(5)
            //alert("ayniGunNobetTutanEczanelerOzet.length: " + ayniGunNobetTutanEczanelerOzet.length)
            if (ayniGunNobetTutanEczanelerOzet.length > 0) {
                //alert(6)
                ayniGunDagilim = $(function table8() {
                    $(icRaporDivId).pivotUI(ayniGunNobetTutanEczanelerOzet,
                        {
                            rows: ["Aynı Gün Nöbet Sayısı"],
                            cols: ["G1 Nöbet Grubu"],
                            vals: ["Aynı Gün Nöbet Sayısı"],
                            aggregatorName: "Say",
                            rendererName: "Sutun Grafik",
                            renderers: $.extend(
                                $.pivotUtilities.renderers,
                                $.pivotUtilities.c3_renderers
                            ),
                            onRefresh: function (config) {
                                //$("#raporMasterDiv").parent().find('.pvtTotal, .pvtTotalLabel, .pvtGrandTotal').remove();
                                //$("#raporMasterDiv").parent().find('.pvtAggregator').hide();
                                PivotAlanlariGosterGizle(pivotAlanlariGoster, icRaporDivId)
                            }
                        }
                    );
                });
            }
            else {
                $("#listeVeriUayri").html(uyariMesaj);
                $("#listeVeriUayri").append(" (Aynı gün dağılım listesi yok.)");
                $("#listeVeriUayri").show();
                //alert('Aynı gün dağılım listesi yok.');
            }
        }
        $('#pills-ayniGunTumu-tab').click(function () {
            $('#btnExceleAktar').hide();
            if (ayniGunDagilim != null) {
                //alert(3)
                ayniGunDagilim;
            }
            else {
                //alert(4)
                ayniGunDagilimlar();
            }
        });

        //eş grupla aynı gün tutulan nöbetler r23
        function AyniGunNobetTutanEsGruplar() {

            //alert("esGrubaAyniGunYazilanNobetler.length: " + esGrubaAyniGunYazilanNobetler.length)

            if (esGrubaAyniGunYazilanNobetler.length > 0) {
                //Aynı Gün Nöbet Tutan
                var tablo = "<table id='gridT' class=\"table table-hover table-striped table-bordered table-sm text-left\">";
                tablo += "<thead class=\"thead-light\">" +
                    "<tr>" +
                    "<th>Grup Tipi</th>" +
                    "<th>Grup Adı</th>" +
                    "<th>Nöbet Tarihi</th>" +
                    "<th>Eczane Sayısı</th>" +
                    "</tr>" +
                    "</thead>" +
                    "<tbody>";
                for (var i = 0; i < esGrubaAyniGunYazilanNobetler.length; i++) {
                    tablo += "<tr class='gridtr'><td>" + esGrubaAyniGunYazilanNobetler[i].EczaneGrupTanimTipAdi
                        + "</td><td>" + esGrubaAyniGunYazilanNobetler[i].EczaneGrupTanimAdi
                        + "</td><td>" + esGrubaAyniGunYazilanNobetler[i].NobetTarihi
                        + "</td><td>" + esGrubaAyniGunYazilanNobetler[i].AyniGunNobetTutanEczaneSayisi + "</td></tr>";
                }

                tablo += "</tbody></table>";
                tablo += "<nav class='navbar navbar-expand-lg navbar-light bg-light' aria-label='...'>";
                tablo += "<ul class='navbar-nav'>";
                tablo += "<li class='nav-link' id='myPaging'></li>";
                tablo += "</ul>";
                tablo += "<div class='nav-item'>Toplam Kayıt: <span id='toplamKayitSayisi'></span></div>";

                document.getElementById(icRaporDivAdi).innerHTML = tablo;

                sayfalamaYap(esGrubaAyniGunYazilanNobetler, 15);
            }
            else {
                var mesaj = "'" + raporBaslik + "'";
                //mesej += ' (Aynı gün aralığında, aynı eş gruptan belirlenen eczane sayısından fazla nöbet yazılma durumu)';
                var divId = 'divUyariRaporlar' + icRaporDivAdi;
                var parentDivId = icRaporDivAdi;
                uyariDivOlustur(mesaj, divId, parentDivId);

                //alert(mesaj);
            }
        }

        $('#pills-esGrup-tab').click(function () {
            AyniGunNobetTutanEsGruplar();
            sayfalamaYap(esGrubaAyniGunYazilanNobetler, 15);
        });

    </script>
    <!-- #endregion -->
    <!-- #region export to excel -->
    <script type="text/javascript">
        var tableToExcel = (function () {

            var uri = 'data:application/vnd.ms-excel;base64,'
                , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table>{table}</table></body></html>'
                , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
                , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }


            return function (table, name) {
                //var ss = icRaporDivId + ' > table';
                //alert(ss)
                //alert($(icRaporDivId).children("table"))
                //$('#testTable thead tr:first').find('th:last').remove();
                //$('#testTable tr').find('td:last').remove();
                //$('#testTable').find('tr:last').remove();
                //alert('table önce: ' + table)
                //alert(table.nodeType)
                var myDiv = document.getElementById(icRaporDivAdi);
                //var myPivotTable = myDiv.getElementsByTagName('table')[0];
                //var myPivotTableIc1 = myPivotTable.getElementsByTagName('tr')[1];
                //var myPivotTableIc2 = myPivotTableIc1.getElementsByTagName('td')[2];

                var pivotTableId = '#' + table;
                //alert(myDiv)
                if (!table.nodeType) table = myDiv.querySelector(pivotTableId) //myPivotTableIc2 //myPivotTable.getElementsByTagName('table')[
                //alert('table sonra: ' + table)
                //document.getElementById(table)
                //$(icRaporDivId).children(table);
                var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }

                window.location.href = uri + base64(format(template, ctx))
            }
        })()

        $root = $('<xml/>');

        //create a workbook
        $workbook = $('<ss:Workbook/>').attr({
            "xmlns:ss": "urn:schemas-microsoft-com:office:spreadsheet",
            "xmlns:x": "urn:schemas-microsoft-com:office:excel",
            "xmlns:o": "urn:schemas-microsoft-com:office:office"
        });

        $root.append($workbook);

        //xlsObject = 'data:application/vnd.ms-excel;base64,' + base64.encode(testXML);
    </script>
    <!-- #endregion -->
    <!-- #region arama -->
    <script>

        //$(".raporKategori").click(function() {

        //    $("#raporId :selected").removeAttr("selected");

        //    // using text value to match second select option groups could just as easily be based on value then label text
        //    var arr = $(this).text();

        //    //alert(arr)

        //    $("#raporId").children("optgroup").hide();
        //    $("#raporId").children("optgroup[label='" + arr + "']").show().selectpicker('refresh');

        //    //$("#raporId").selectpicker('refresh');
        //    //if (arr !== 'All') { // arbitrary value to show all
        //    //  $("#raporId").children("optgroup").hide();
        //    //  $("#raporId").children("optgroup[label='" + arr + "']").show();
        //    //} else {
        //    //  $("#raporId").children("optgroup").show();
        //    //}

        //});

        //$('.raporKategori').click(function () {

        //    var $sel = $('#raporId'),
        //        val = $(this).text(),
        //        rapor = $.trim(val);

        //    alert("buton: " + val)
        //    alert("rapor: " + rapor)
        //    $('span > optgroup', $sel).unwrap();

        //    $('#raporId > li:not(:contains(' + value + '))').hide();
        //    //$('#raporId > li:contains(' + value + ')').show();
        //    //console.log($('span > optgroup', $sel).unwrap())
        //    //alert('#raporId > optgroup:not([label="' + rapor + '"])')
        //    //$('#raporId > optgroup:not([label="' + rapor + '"])', $sel).wrap('<span/>');
        //    //if (val !== '%') {
        //    //}
        //});

        //$('select[name="region"]').change(function() {
        //    var $sel = $('select[name="campus"]'),
        //        val = $(this).val(),
        //        campus = $('option:selected', this).text();
        //    $('span > optgroup', $sel).unwrap();
        //    if (val !== '%') {
        //        $('optgroup:not([label="' + campus + '"])', $sel).wrap('<span/>');
        //    }
        //});

        function raporParamsBelirle() {
            raporId = $('#raporId :selected').val();
            raporBaslik = $('#raporId :selected').text().split(". ")[1];
        }

        //$("#raporId").change(function (e) {
        //    raporParamsBelirle();
        //    //alert("raporId: " + raporBaslik)
        //    //alert("raporBaslik: " + raporBaslik)

        //    //baslangicTarihi = null;
        //    //$('#BaslangicTarihi').data('datepicker').setDate(null);
        //    ////alert("2")
        //    //$("#btnSilBaslangicTarihi").hide();
        //    //$("#btnSilBaslangicTarihiFiltre").show();

        //});

        function getNobetGrubu() {
            //alert(1)

            nobetGrubu = [];

            //if ($('#nobetGrupGorevTipId :selected').length == 0) {
            //    nobetGrubu.push({ Id: -9 });
            //}
            //else {
            $('#nobetGrupGorevTipId :selected').each(function () {
                nobetGrubu.push({ Id: parseInt($(this).val()) });
            });
            //}
            //alert(2)
            //console.log(nobetGrubu)
            return nobetGrubu;// + ' ' + selected.text();
        }

        function sonucAra() {
            //dağılımlar
            dagilimlarFiltreli = $.grep(dagilimlarTumu, function (n, i) {
                return n["Id"] == nobetGrubu || nobetGrubu == 0;
            });
            dagilimlarPivot = dagilimlarFiltreli;

            //alert(gunDagilimiMaxMinTumu.length)
            //gün dağılım grafik
            gunDagilimiMaxMinFiltreli = $.grep(gunDagilimiMaxMinTumu, function (n, i) {
                return n["Id"] == nobetGrubu || nobetGrubu == 0;
            });
            gunDagilimiMaxMin = gunDagilimiMaxMinFiltreli;

            //gün farkları
            //özet
            gunFarklariFrekanslarFiltreli = $.grep(gunFarklariFrekanslarTumu, function (n, i) {
                return n["Id"] == nobetGrubu || nobetGrubu == 0;
            });
            gunFarklariFrekanslar = gunFarklariFrekanslarFiltreli;

            //diğer
            gunFarklariTumSonuclarFiltreli = $.grep(gunFarklariTumSonuclarTumu, function (n, i) {
                return n["Id"] == nobetGrubu || nobetGrubu == 0;
            });
            gunFarklariTumSonuclar = gunFarklariTumSonuclarFiltreli;

            //nöbet borç
            alacakVerecekLitesiFiltreli = $.grep(alacakVerecekLitesiTumu, function (n, i) {
                return n["Id"] == nobetGrubu || nobetGrubu == 0;
            });
            alacakVerecekLitesi = alacakVerecekLitesiFiltreli;

            dagilimlarPlanlananGerceklesenFiltreli = $.grep(dagilimlarPlanlananGerceklesenTumu, function (n, i) {
                return n["Id"] == nobetGrubu || nobetGrubu == 0;
            });
            dagilimlarPlanlananGerceklesen = dagilimlarPlanlananGerceklesenFiltreli;

            //if (nobetGrubu == " Tüm Gruplar") {
            //    dagilimlarPivot = dagilimlarTumu;
            //    gunFarklariFrekanslar = gunFarklariFrekanslarTumu;
            //    gunFarklariTumSonuclar = gunFarklariTumSonuclarTumu;
            //    alacakVerecekLitesi = alacakVerecekLitesiTumu;
            //}
            //else {
            //    //dağılımlar
            //    dagilimlarFiltreli = $.grep(dagilimlarTumu, function (n, i) {
            //        return n["Nöbet Grubu"] == nobetGrubu;
            //    });
            //    dagilimlarPivot = dagilimlarFiltreli;

            //    //gün farkları
            //    //özet
            //    gunFarklariFrekanslarFiltreli = $.grep(gunFarklariFrekanslarTumu, function (n, i) {
            //        return n["Nöbet Grubu"] == nobetGrubu;
            //    });
            //    gunFarklariFrekanslar = gunFarklariFrekanslarFiltreli;

            //    //diğer
            //    gunFarklariTumSonuclarFiltreli = $.grep(gunFarklariTumSonuclarTumu, function (n, i) {
            //        return n["Nöbet Grubu"] == nobetGrubu;
            //    });
            //    gunFarklariTumSonuclar = gunFarklariTumSonuclarFiltreli;

            //    //nöbet borç
            //    alacakVerecekLitesiFiltreli = $.grep(alacakVerecekLitesiTumu, function (n, i) {
            //        return n["Nöbet Grubu"] == nobetGrubu;
            //    });
            //    alacakVerecekLitesi = alacakVerecekLitesiFiltreli;
            //}
        }

        function pivotSekilleriSifirla() {

            dagilimlar = null;
            dagilimlarTumu = null;
            dagilimlarPivot = new Array();

            eczaneNobetAlacakVerecek = null;
            alacakVerecekLitesi = new Array();
            dagilimlarPlanlananGerceklesen = new Array();

            ayniGunNobet = null;
            ayniGunNobetTutanEczanelerOzet = new Array();
            ayniGunNobetTutanEczaneler = new Array();

            nobetciEczaneler = null;
            nobetciEczanelerMazeretIstek = null;
            gunGrafik = null;
            gunDagilim = null;
            gunDagilimBayramlar = null;
            gunDagilimHaftaIci = null;
            gunDagilim2 = null;
            gunGrafik2 = null;
            ayDagilim = null;
            mevsimDagilim = null;
            ikiliAyDagilim = null;
            tarihDagilim = null;
            nobetDurumDagilim = null;
            kalibrasyonluNobetDagilim = null;

            gunFarkiGrafikVeri = null;
            gunFarkiOzetListesi = null;
            gunFarkiFrekansListesi = null;
            gunFarkiDonguListesi = null;
            gunFarkiDetayliArtanListesi = null;
            gunFarkiDetayliAzalanListesi = null;

            alacakVerecekGrafikVeri = null;
            alacakVereceklerOzet = null;
            alacakVereceklerList = null;

            altGrupDagilim = null;
            altGrupSirali = null;
            ayniGunDagilim = null;
            ayniGunDagilimTablo = null;
            planlananVeGerceklesenNobetListesi = null;
        }

        function pivotlariGuncelle() {
            if ($("#pills-dagilim-tab").hasClass("active")) {
                if ($("#pills-nobetci-tab").hasClass("active")) {
                    //alert("#pills-nobetci-tab")
                    pivotSekilleriSifirla();
                    nobetciListesi();
                }
                else if ($("#pills-gunOzetGrafik-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    gunGrafikOlustur();
                }
                else if ($("#pills-gunDagilimGrafik-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    gunDagilimGrafikler();
                }
                else if ($("#pills-gun-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    gunDagilimlar();
                }
                else if ($("#pills-ay-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    ayDagilimlar();
                }
                else if ($("#pills-mevsim-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    mevsimDagilimlar();
                }
                else if ($("#pills-tarih-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    tarihDagilimlar();
                }
            }
            else if ($("#pills-gunFarki-tab").hasClass("active")) {
                if ($("#pills-gunFarkiGrafik-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    gunFarkiGrafik();
                }
                if ($("#pills-ozet-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    gunFarkiOzet();
                }
                else if ($("#pills-frekans-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    gunFarkiFrekans();
                }
                else if ($("#pills-dongu-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    donguler();
                }
                else if ($("#pills-detayliArtan-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    gunFarkiDetayliArtanlar();
                }
                else if ($("#pills-detayliAzalan-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    gunFarkiDetayliAzalanlar();
                }
            }
            else if ($("#pills-nobetBorc-tab").hasClass("active")) {
                if ($("#pills-alacakVerecekGrafik-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    alacakVerecekGrafik();
                }
                else if ($("#pills-alacakVerecek-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    alacakVerecekOzet();
                }
                else if ($("#pills-alacakVerecekListesi-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    alacakVerecekListe();
                }
                else if ($("#pills-planlananVsGerceklesen-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    planlananVeGerceklesenNobetler();
                }
            }
            else if ($("#pills-altGrupTakip-tab").hasClass("active")) {
                if ($("#pills-altGrup-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    altGrupDagilimlar();
                }
                else if ($("#pills-altGrupGunGrupDagilim-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    altGrupGunGrupDagilimlar();
                }
                else if ($("#pills-altGrupSirali-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    altGrupSiraliDagilimlar();
                }
            }
            else if ($("#pills-ayniGuneYazilanlar-tab").hasClass("active")) {
                if ($("#pills-ayniGunTumu-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    ayniGunDagilimlar();
                }
                else if ($("#pills-esGrup-tab").hasClass("active")) {
                    pivotSekilleriSifirla();
                    ayniGunDagilimlar();
                }
            }
        }

        function tarihDondur(metin) {
            var tarihTanim = metin.split(" ");
            yil = parseInt(tarihTanim[0]);
            ay = parseInt(tarihTanim[1]);
            gun = parseInt(tarihTanim[2]);
            return new Date(yil, ay - 1, gun);
        }

        function tarihAralik() {

            if ($('#BaslangicTarihi').val().length > 0) {
                //alert("BaslangicTarihi dolu")
                baslangicTarihi = $('#BaslangicTarihi').val();
            }
            else {
                //alert("BaslangicTarihi boş")
                baslangicTarihi = null;
            }

            if ($('#BitisTarihi').val().length > 0) {
                //alert("BitisTarihi dolu")
                bitisTarihi = $('#BitisTarihi').val();
            }
            else {
                //alert("BitisTarihi boş")
                bitisTarihi = null;
            }
            //alert('baş. tarihi: ' + baslangicTarihi + ', bit. tarihi: ' + bitisTarihi)

            if (baslangicTarihi == null && bitisTarihi == null) {
                //alert(1 + " baslangicTarihi == null && bitisTarihi == null")
                //dagilimlarPivot = dagilimlarTumu;
                sonucAra();
                pivotlariGuncelle();
            }
            else if (bitisTarihi == null) {
                //alert(2 + " baş. tarihi: " + baslangicTarihi + " bitisTarihi == null")
                dagilimlarFiltreli = $.grep(dagilimlarTumu, function (n, i) {
                    var tarih = tarihDondur(n.Tarih2);
                    return tarih >= new Date(baslangicTarihi) && (n["Id"] == nobetGrubu || nobetGrubu == 0);
                });

                dagilimlarPivot = dagilimlarFiltreli;
                pivotlariGuncelle();
            }
            else if (baslangicTarihi == null) {
                //alert(3)
                dagilimlarFiltreli = $.grep(dagilimlarTumu, function (n, i) {
                    var tarih = tarihDondur(n.Tarih2);
                    return tarih <= new Date(bitisTarihi) && (n["Id"] == nobetGrubu || nobetGrubu == 0);
                });

                dagilimlarPivot = dagilimlarFiltreli;
                pivotlariGuncelle();
            }
            else if (baslangicTarihi != null && bitisTarihi != null) {
                //alert(4 + " baslangicTarihi != null && bitisTarihi != null")
                if (baslangicTarihi > bitisTarihi) {
                    alert("Başlangıç tarihi (" + baslangicTarihi + ") bitiş tarihinden (" + bitisTarihi + ") büyük olamaz!!!.");
                    //e.preventDefault();
                    return false;
                };

                dagilimlarFiltreli = $.grep(dagilimlarTumu, function (n, i) {
                    var tarih = tarihDondur(n.Tarih2);
                    return (tarih >= new Date(baslangicTarihi) && tarih <= new Date(bitisTarihi)) && (n["Id"] == nobetGrubu || nobetGrubu == 0);
                });

                dagilimlarPivot = dagilimlarFiltreli;
                pivotlariGuncelle();
            }
            else if (baslangicTarihi != null) {
                //alert(5 + " baslangicTarihi != null")
                dagilimlarFiltreli = $.grep(dagilimlarTumu, function (n, i) {
                    var tarih = tarihDondur(n.Tarih2);
                    return tarih >= new Date(baslangicTarihi) && (n["Id"] == nobetGrubu || nobetGrubu == 0);
                });

                dagilimlarPivot = dagilimlarFiltreli;
                pivotlariGuncelle();
            }
            else {
                //alert(6 + " bitisTarihi != null")
                dagilimlarFiltreli = $.grep(dagilimlarTumu, function (n, i) {
                    var tarih = tarihDondur(n.Tarih2);
                    return tarih <= new Date(bitisTarihi) && (n["Id"] == nobetGrubu || nobetGrubu == 0);
                });

                dagilimlarPivot = dagilimlarFiltreli;
                pivotlariGuncelle();
            }
        }

        $("#btnSilBaslangicTarihi").click(function () {
            baslangicTarihi = null;
            $('#TarihBaslangic').data('datepicker').setDate(null);
            //alert("2")
            $("#btnSilBaslangicTarihi").hide();
            $("#btnSilBaslangicTarihiFiltre").show();
        });

        $("#btnSilBitisTarihi").click(function () {
            bitisTarihi = null;
            $('#TarihBitis').data('datepicker').setDate(null);
            $("#btnSilBitisTarihi").hide();
            $("#btnSilBitisTarihiFiltre").show();
        });

        $("#nobetGrupGorevTipId").change(function () {
            nobetGrubu = getNobetGrubu();
            //alert(1)
            //tarihAralik();
            //pivotlariGuncelle();
        });

        $("#BaslangicTarihi").change(function () {
            //alert("BaslangicTarihi change")
            //tarihAralik();
            //pivotlariGuncelle();
        });

        $("#BitisTarihi").change(function () {
            //tarihAralik();
            //pivotlariGuncelle();
        });

        function tarihAyir(tarih) {
            var tarihParcali = tarih.substring(0, 10).split("/");
            return tarihParcali[1] + "." + tarihParcali[0] + "." + tarihParcali[2];
        }

        function tarihiTrdenCevir(metin) {

            var tarihTanim = metin.substring(0, 10).split(".");

            yil = tarihTanim[2];
            ay = tarihTanim[1];
            gun = tarihTanim[0];

            return yil + "." + ay + "." + gun;
        }

        $("#TarihBaslangic").change(function () {
            if ($("#TarihBaslangic").val() != null) {
                //alert("BaslangicTarihi != null " + $("#BaslangicTarihi").val())
                $("#btnSilBaslangicTarihiFiltre").hide();
                $("#btnSilBaslangicTarihi").show();
            }
            var d = tarihiTrdenCevir(this.value);
            $('#BaslangicTarihi').val(d);
        });

        $("#TarihBitis").change(function () {
            if ($("#TarihBitis").val() != null) {
                $("#btnSilBitisTarihiFiltre").hide();
                $("#btnSilBitisTarihi").show();
            }
            var d = tarihiTrdenCevir(this.value);
            $('#BitisTarihi').val(d);
        });

    </script>
    <!-- #endregion -->
    <!-- #region document ready -->
    <script>

        toastr.options = {
            "closeButton": true,
            "debug": false,
            "newestOnTop": true,
            "progressBar": false,
            "positionClass": "toast-top-center",
            "preventDuplicates": false,
            "onclick": null,
            "showDuration": "2000",
            "hideDuration": "1000",
            "timeOut": "5000",
            "extendedTimeOut": "2000",
            "showEasing": "swing",
            "hideEasing": "linear",
            "showMethod": "fadeIn",
            "hideMethod": "fadeOut"
        }

        var cozumModel = @Html.Raw(Json.Encode(Model.EczaneNobetSonuclar));

        //var baslangicTarihi = $('#baslangicTarihi').val();
        //var bitisTarihi = $('#bitisTarihi').val();
        var kisitSayisi = cozumModel.KisitSayisi;
        var calismaSayisi = cozumModel.CalismaSayisi;
        var iterasyonSayisi = cozumModel.IterasyonSayisi;

        var kararDegiskeniSayisi = cozumModel.KararDegikeniSayisi;
        var objectiveValue = cozumModel.ObjectiveValue;//.replace(".", ",");
        var cozumSuresi = $('#CozumSuresi').val();
        var sure = $('#sure').val();//.replace(",", ".");

        var s = timeSpanAyir(cozumSuresi);

        function denemeSayisi() {
            if (parseInt(calismaSayisi) > 0) {
                return '<br/>-------------'
                    + '<br/>Çalışma Sayısı : ' + calismaSayisi;
            }
            else {
                return "";
            }
        }

        function iterasyon() {
            if (parseInt(iterasyonSayisi) > 0) {
                return '<br/>İterasyon Sayısı : ' + iterasyonSayisi;
            }
            else {
                return "";
            }
        }

        function toastMesaj() {

            toastr.clear();

            if (parseInt(s[1]) > 0) {
                var mesaj = //'( ' + tarihAyir(baslangicTarihi) + '-' + tarihAyir(bitisTarihi) + ' )'
                      'Amaç Değeri : ' + objectiveValue.toFixed(3)
                    + '<br/>Kısıt Sayısı : ' + kisitSayisi
                    + '<br/>Değişken Sayısı : ' + kararDegiskeniSayisi
                    + '<br/>Çözüm Süresi : ' + timeSpanFormatla(cozumSuresi)
                    + '<br/>Toplam Süre  : ' + timeSpanFormatla(sure)
                    + denemeSayisi()
                    + iterasyon();
                toastr.success(mesaj, "Çözüm İstatistiği");
            }
        }

        function timeSpanAyir(zaman) {
            var tarihParcali = zaman.split(".");
            return tarihParcali; //[1] + "." + tarihParcali[0] + "." + tarihParcali[2];
        }

        function timeSpanFormatla(zaman) {
            var tarihParcali = zaman.split(".");
            return tarihParcali[0] + "." + tarihParcali[1].substring(0,2);
        }

        $('#btnCozumIstatistik').click(function () {
           // alert(1)
            toastMesaj();
        });

        function baslangicTarihindenSonrakiGunuSec(d) {
            //console.log(d)
            var bsl = new Date(d.getFullYear(), d.getMonth(), d.getDate()+1);
            //d.setDate(d.getDate()+1);
            //console.log(bsl)
            return bsl;
        }

        function baslangicTarihininIlkGununuSec(d) {
            //console.log(d)
            var bsl = new Date(d.getFullYear(), d.getMonth(), 1);
            //d.setDate(1);
            //console.log(bsl)
            return bsl;
        }

        function bitisTarihininSonGununuSec(d) {
            var aydakiGunSayisi = daysInMonth(d.getMonth() + 1, d.getFullYear());
            var bitisTarihi = d.setDate(aydakiGunSayisi);
            return new Date(bitisTarihi);
        }

        function daysInMonth(month, year) {
            return new Date(year, month, 0).getDate();
        }

        $(function () {

            $('.datepicker').datepicker('setStartDate', "01-01-1900");

            //alert(sonNobetTarihi)
            var tarih = new Date();

            //var aydakiGunSayisi = daysInMonth(tarih.getMonth() + 1, tarih.getFullYear());
            //alert(aydakiGunSayisi)

            var bsl = baslangicTarihininIlkGununuSec(tarih);

            //var bit = bitisTarihininSonGununuSec(tarih);
            //var baslangicStr = tarihDondur2($("#BaslangicTarihi").val());

            //alert(bsl)
            //alert(baslangicStr)
            //$("#BaslangicTarihi").datepicker("setDate", new Date(baslangicStr));
            $("#TarihBaslangic").datepicker("setDate", new Date());
            //$("#TarihBaslangic").datepicker("setStartDate", new Date(baslangicStr));

            //var bitisStr = tarihDondur2($("#BitisTarihi").val());

            //$("#BitisTarihi").datepicker("setDate", new Date(bitisStr));
            //$("#TarihBitis").datepicker("setDate", new Date(bit));
            //$("#TarihBitis").datepicker("setStartDate", new Date(baslangicStr));

            $('.input-daterange').datepicker();

            nobetGrubu = getNobetGrubu();
            raporParamsBelirle();

            //var sure = parseInt($('#sure').val());
            //console.log(nobetGrubu)
            //$("#BaslangicTarihi").datepicker("setDate", new Date());

            if (parseInt(s[1]) > 0 || s[1] != null) {
                $('#btnCozumIstatistik').show();
            }

            toastMesaj();

            //if (sure > 0) {
            //    toastr.success('Çözüm Süresi: ' + sure + ' saniye');
            //}
            //$(".ui-helper-hidden-accessible").hide();
            //$(".ui-helper-hidden-accessible").remove();
            //$(".ui-helper-hidden-accessible").addClass("text-white");
            $(document).ajaxStart(function () {
                $("#wait").show();
            });
            $(document).ajaxComplete(function () {
                //alert("ajax completed")
                $("#wait").hide();
                $("#filtre").show();
                $("#btnExceleAktar").show();
                $("#raporlar").show();
            });
        });
    </script>
    <!-- #endregion -->
    <!-- #endregion -->

}